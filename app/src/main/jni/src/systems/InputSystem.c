/** updated by adriac */
/* InputSystem.c generated by valac 0.36.4-dirty, the Vala compiler
 * generated from InputSystem.vala, do not modify */

/*[Adriac:Systems::InputSystem:SystemsInputSystem:systems_input_system]*/

#include <glib.h>
#include <glib-object.h>
#include <float.h>
#include <math.h>
#include <stdlib.h>
#include <string.h>
#include <SDL_rect.h>
#include <SDL_keyboard.h>

typedef struct _EntitasSystem EntitasSystem;
typedef EntitasSystem SystemsInputSystem;
typedef struct _SdxAbstractGame SdxAbstractGame;
typedef SdxAbstractGame Game;
typedef struct _EntitasWorld EntitasWorld;
typedef EntitasWorld Factory;
typedef struct _EntitasGroup EntitasGroup;
// symtbl.1 entitas_world
void entitas_world_release (EntitasWorld* self);
void entitas_world_free (EntitasWorld* self);
EntitasWorld* entitas_world_retain (EntitasWorld* self);
#define _entitas_world_release0(var) ((var == NULL) ? NULL : (var = (entitas_world_release (var), NULL)))
typedef struct _Block33Data Block33Data;
// symtbl.1 entitas_group
void entitas_group_release (EntitasGroup* self);
void entitas_group_free (EntitasGroup* self);
EntitasGroup* entitas_group_retain (EntitasGroup* self);
#define _entitas_group_release0(var) ((var == NULL) ? NULL : (var = (entitas_group_release (var), NULL)))
// symtbl.1 entitas_system
void entitas_system_release (EntitasSystem* self);
void entitas_system_free (EntitasSystem* self);
EntitasSystem* entitas_system_retain (EntitasSystem* self);
#define _entitas_system_release0(var) ((var == NULL) ? NULL : (var = (entitas_system_release (var), NULL)))
typedef struct _EntitasMatcher EntitasMatcher;

#define ENTITAS_TYPE_COMPONENTS (entitas_components_get_type ())
// symtbl.1 entitas_matcher
void entitas_matcher_release (EntitasMatcher* self);
void entitas_matcher_free (EntitasMatcher* self);
EntitasMatcher* entitas_matcher_retain (EntitasMatcher* self);
#define _entitas_matcher_release0(var) ((var == NULL) ? NULL : (var = (entitas_matcher_release (var), NULL)))

#define ENTITAS_TYPE_ENTITY (entitas_entity_get_type ())

#define ENTITAS_TYPE_TRANSFORM (entitas_transform_get_type ())

#define SDX_MATH_TYPE_VECTOR2 (sdx_math_vector2_get_type ())
typedef struct _SdxMathVector2 SdxMathVector2;
typedef struct _SdxGraphicsSprite SdxGraphicsSprite;
typedef struct _EntitasTransform EntitasTransform;
typedef struct _EntitasEventEntityChanged EntitasEventEntityChanged;
typedef struct _EntitasEventEntityReleased EntitasEventEntityReleased;
typedef struct _EntitasEventComponentReplaced EntitasEventComponentReplaced;

#define ENTITAS_TYPE_BACKGROUND (entitas_background_get_type ())
typedef struct _EntitasBackground EntitasBackground;

#define ENTITAS_TYPE_BULLET (entitas_bullet_get_type ())
typedef struct _EntitasBullet EntitasBullet;

#define ENTITAS_TYPE_ENEMY1 (entitas_enemy1_get_type ())
typedef struct _EntitasEnemy1 EntitasEnemy1;

#define ENTITAS_TYPE_ENEMY2 (entitas_enemy2_get_type ())
typedef struct _EntitasEnemy2 EntitasEnemy2;

#define ENTITAS_TYPE_ENEMY3 (entitas_enemy3_get_type ())
typedef struct _EntitasEnemy3 EntitasEnemy3;

#define ENTITAS_TYPE_EXPIRES (entitas_expires_get_type ())
typedef struct _EntitasExpires EntitasExpires;

#define ENTITAS_TYPE_HEALTH (entitas_health_get_type ())
typedef struct _EntitasHealth EntitasHealth;

#define ENTITAS_TYPE_HUD (entitas_hud_get_type ())
typedef struct _EntitasHud EntitasHud;

#define ENTITAS_TYPE_LAYER (entitas_layer_get_type ())
typedef struct _EntitasLayer EntitasLayer;

#define ENTITAS_TYPE_PLAYER (entitas_player_get_type ())
typedef struct _EntitasPlayer EntitasPlayer;

#define ENTITAS_TYPE_SHOW (entitas_show_get_type ())
typedef struct _EntitasShow EntitasShow;

#define ENTITAS_TYPE_SOUND (entitas_sound_get_type ())
typedef struct _SdxAudioSound SdxAudioSound;
typedef struct _EntitasSound EntitasSound;

#define ENTITAS_TYPE_TEXT (entitas_text_get_type ())
typedef SdxGraphicsSprite SdxGraphicsSpriteTextSprite;
typedef struct _EntitasText EntitasText;

#define ENTITAS_TYPE_TINT (entitas_tint_get_type ())
typedef struct _EntitasTint EntitasTint;

#define ENTITAS_TYPE_TWEEN (entitas_tween_get_type ())
typedef struct _EntitasTween EntitasTween;

#define ENTITAS_TYPE_VELOCITY (entitas_velocity_get_type ())
typedef struct _EntitasVelocity EntitasVelocity;
typedef struct _EntitasEntity EntitasEntity;
typedef struct _SdxInputProcessor SdxInputProcessor;
// symtbl.1 sdx_input_processor
void sdx_input_processor_release (SdxInputProcessor* self);
void sdx_input_processor_free (SdxInputProcessor* self);
SdxInputProcessor* sdx_input_processor_retain (SdxInputProcessor* self);
#define _sdx_input_processor_release0(var) ((var == NULL) ? NULL : (var = (sdx_input_processor_release (var), NULL)))

typedef void (*EntitasSystemInitialize) (void* user_data);
typedef void (*EntitasSystemExecute) (gfloat delta, void* user_data);
struct _EntitasSystem {
	gint ref_count;
	EntitasSystemInitialize Initialize;
	gpointer Initialize_target;
	GDestroyNotify Initialize_target_destroy_notify;
	EntitasSystemExecute Execute;
	gpointer Execute_target;
	GDestroyNotify Execute_target_destroy_notify;
};

struct _Block33Data {
	int _ref_count_;
	SystemsInputSystem* self;
	gint x;
	gint y;
	gboolean mouseDown;
	gboolean shoot;
	gfloat timeToFire;
	EntitasGroup* player;
	Factory* world;
};

typedef enum  {
	ENTITAS_COMPONENTS_UnknownComponent,
	ENTITAS_COMPONENTS_BackgroundComponent,
	ENTITAS_COMPONENTS_BulletComponent,
	ENTITAS_COMPONENTS_Enemy1Component,
	ENTITAS_COMPONENTS_Enemy2Component,
	ENTITAS_COMPONENTS_Enemy3Component,
	ENTITAS_COMPONENTS_ExpiresComponent,
	ENTITAS_COMPONENTS_HealthComponent,
	ENTITAS_COMPONENTS_HudComponent,
	ENTITAS_COMPONENTS_LayerComponent,
	ENTITAS_COMPONENTS_PlayerComponent,
	ENTITAS_COMPONENTS_ShowComponent,
	ENTITAS_COMPONENTS_SoundComponent,
	ENTITAS_COMPONENTS_TextComponent,
	ENTITAS_COMPONENTS_TintComponent,
	ENTITAS_COMPONENTS_TweenComponent,
	ENTITAS_COMPONENTS_VelocityComponent
} EntitasComponents;

struct _SdxMathVector2 {
	gfloat x;
	gfloat y;
};

struct _EntitasTransform {
	SdxMathVector2* scale;
	SdxMathVector2* position;
	SDL_Rect* aabb;
	SdxGraphicsSprite* sprite;
};

struct _EntitasBackground {
	gboolean active;
};

struct _EntitasBullet {
	gboolean active;
};

struct _EntitasEnemy1 {
	gboolean active;
};

struct _EntitasEnemy2 {
	gboolean active;
};

struct _EntitasEnemy3 {
	gboolean active;
};

struct _EntitasExpires {
	gfloat value;
};

struct _EntitasHealth {
	gfloat current;
	gfloat maximum;
};

struct _EntitasHud {
	gboolean active;
};

struct _EntitasLayer {
	gint value;
};

struct _EntitasPlayer {
	gboolean active;
};

struct _EntitasShow {
	gboolean active;
};

struct _EntitasSound {
	SdxAudioSound* sound;
};

struct _EntitasText {
	gchar* text;
	SdxGraphicsSpriteTextSprite* sprite;
};

struct _EntitasTint {
	gint r;
	gint g;
	gint b;
	gint a;
};

struct _EntitasTween {
	gfloat min;
	gfloat max;
	gfloat speed;
	gboolean repeat;
	gboolean active;
};

struct _EntitasVelocity {
	gfloat x;
	gfloat y;
};

struct _EntitasEntity {
	gint id;
	gchar* name;
	gint pool;
	guint64 mask;
	EntitasTransform transform;
	EntitasEventEntityChanged* onComponentAdded;
	EntitasEventEntityChanged* onComponentRemoved;
	EntitasEventEntityReleased* onEntityReleased;
	EntitasEventComponentReplaced* onComponentReplaced;
	EntitasBackground* background;
	EntitasBullet* bullet;
	EntitasEnemy1* enemy1;
	EntitasEnemy2* enemy2;
	EntitasEnemy3* enemy3;
	EntitasExpires* expires;
	EntitasHealth* health;
	EntitasHud* hud;
	EntitasLayer* layer;
	EntitasPlayer* player;
	EntitasShow* show;
	EntitasSound* sound;
	EntitasText* text;
	EntitasTint* tint;
	EntitasTween* tween;
	EntitasVelocity* velocity;
};

typedef gboolean (*SdxInputProcessorInputProcessorKeyDown) (gint keycode, void* user_data);
typedef gboolean (*SdxInputProcessorInputProcessorKeyUp) (gint keycode, void* user_data);
typedef gboolean (*SdxInputProcessorInputProcessorTouchDown) (gint x, gint y, gint pointer, gint button, void* user_data);
typedef gboolean (*SdxInputProcessorInputProcessorTouchUp) (gint x, gint y, gint pointer, gint button, void* user_data);
typedef gboolean (*SdxInputProcessorInputProcessorTouchDragged) (gint x, gint y, gint pointer, void* user_data);
typedef gboolean (*SdxInputProcessorInputProcessorMouseMoved) (gint x, gint y, void* user_data);


void entitas_system_free (EntitasSystem * self);
#define SYSTEMS_INPUT_SYSTEM_FIRE_RATE 0.1f
void sdx_abstract_game_free (SdxAbstractGame * self);
void entitas_world_free (EntitasWorld * self);
SystemsInputSystem* systems_input_system_new (Game* game, Factory* world);
void entitas_group_free (EntitasGroup * self);
static Block33Data* block33_data_ref (Block33Data* _data33_);
static void block33_data_unref (void * _userdata_);
EntitasSystem* entitas_system_new (void);
void entitas_matcher_free (EntitasMatcher * self);
EntitasGroup* entitas_world_GetGroup (EntitasWorld* self, EntitasMatcher* matcher);
EntitasMatcher* entitas_matcher_AllOf (gint* components, int components_length1);
GType entitas_components_get_type (void) G_GNUC_CONST;
static void __lambda119_ (Block33Data* _data33_, gfloat delta);
GType entitas_entity_get_type (void) G_GNUC_CONST;
GType entitas_transform_get_type (void) G_GNUC_CONST;
GType sdx_math_vector2_get_type (void) G_GNUC_CONST;
SdxMathVector2* sdx_math_vector2_dup (const SdxMathVector2* self);
void sdx_math_vector2_free (SdxMathVector2* self);
void sdx_graphics_sprite_free (SdxGraphicsSprite * self);
EntitasTransform* entitas_transform_dup (const EntitasTransform* self);
void entitas_transform_free (EntitasTransform* self);
void entitas_transform_copy (const EntitasTransform* self, EntitasTransform* dest);
void entitas_transform_destroy (EntitasTransform* self);
void entitas_event_entity_changed_free (EntitasEventEntityChanged * self);
void entitas_event_entity_released_free (EntitasEventEntityReleased * self);
void entitas_event_component_replaced_free (EntitasEventComponentReplaced * self);
GType entitas_background_get_type (void) G_GNUC_CONST;
EntitasBackground* entitas_background_dup (const EntitasBackground* self);
void entitas_background_free (EntitasBackground* self);
GType entitas_bullet_get_type (void) G_GNUC_CONST;
EntitasBullet* entitas_bullet_dup (const EntitasBullet* self);
void entitas_bullet_free (EntitasBullet* self);
GType entitas_enemy1_get_type (void) G_GNUC_CONST;
EntitasEnemy1* entitas_enemy1_dup (const EntitasEnemy1* self);
void entitas_enemy1_free (EntitasEnemy1* self);
GType entitas_enemy2_get_type (void) G_GNUC_CONST;
EntitasEnemy2* entitas_enemy2_dup (const EntitasEnemy2* self);
void entitas_enemy2_free (EntitasEnemy2* self);
GType entitas_enemy3_get_type (void) G_GNUC_CONST;
EntitasEnemy3* entitas_enemy3_dup (const EntitasEnemy3* self);
void entitas_enemy3_free (EntitasEnemy3* self);
GType entitas_expires_get_type (void) G_GNUC_CONST;
EntitasExpires* entitas_expires_dup (const EntitasExpires* self);
void entitas_expires_free (EntitasExpires* self);
GType entitas_health_get_type (void) G_GNUC_CONST;
EntitasHealth* entitas_health_dup (const EntitasHealth* self);
void entitas_health_free (EntitasHealth* self);
GType entitas_hud_get_type (void) G_GNUC_CONST;
EntitasHud* entitas_hud_dup (const EntitasHud* self);
void entitas_hud_free (EntitasHud* self);
GType entitas_layer_get_type (void) G_GNUC_CONST;
EntitasLayer* entitas_layer_dup (const EntitasLayer* self);
void entitas_layer_free (EntitasLayer* self);
GType entitas_player_get_type (void) G_GNUC_CONST;
EntitasPlayer* entitas_player_dup (const EntitasPlayer* self);
void entitas_player_free (EntitasPlayer* self);
GType entitas_show_get_type (void) G_GNUC_CONST;
EntitasShow* entitas_show_dup (const EntitasShow* self);
void entitas_show_free (EntitasShow* self);
GType entitas_sound_get_type (void) G_GNUC_CONST;
void sdx_audio_sound_free (SdxAudioSound * self);
EntitasSound* entitas_sound_dup (const EntitasSound* self);
void entitas_sound_free (EntitasSound* self);
void entitas_sound_copy (const EntitasSound* self, EntitasSound* dest);
void entitas_sound_destroy (EntitasSound* self);
GType entitas_text_get_type (void) G_GNUC_CONST;
EntitasText* entitas_text_dup (const EntitasText* self);
void entitas_text_free (EntitasText* self);
void entitas_text_copy (const EntitasText* self, EntitasText* dest);
void entitas_text_destroy (EntitasText* self);
GType entitas_tint_get_type (void) G_GNUC_CONST;
EntitasTint* entitas_tint_dup (const EntitasTint* self);
void entitas_tint_free (EntitasTint* self);
GType entitas_tween_get_type (void) G_GNUC_CONST;
EntitasTween* entitas_tween_dup (const EntitasTween* self);
void entitas_tween_free (EntitasTween* self);
GType entitas_velocity_get_type (void) G_GNUC_CONST;
EntitasVelocity* entitas_velocity_dup (const EntitasVelocity* self);
void entitas_velocity_free (EntitasVelocity* self);
EntitasEntity* entitas_entity_dup (const EntitasEntity* self);
void entitas_entity_free (EntitasEntity* self);
void entitas_entity_copy (const EntitasEntity* self, EntitasEntity* dest);
void entitas_entity_destroy (EntitasEntity* self);
EntitasEntity* entitas_group_GetSingleEntity (EntitasGroup* self);
EntitasEntity* entitas_entity_SetPosition (EntitasEntity *self, gfloat x, gfloat y);
void factory_AddBullet (Factory* self, gint x, gint y);
static void ___lambda119__entitas_system_execute (gfloat delta, gpointer self);
void sdx_input_processor_free (SdxInputProcessor * self);
void sdx_AddInputProcessor (SdxInputProcessor* processor);
SdxInputProcessor* sdx_input_processor_new (void);
SdxInputProcessor* sdx_input_processor_SetKeyDown (SdxInputProcessor* self, SdxInputProcessorInputProcessorKeyDown keyDown, void* keyDown_target);
static gboolean __lambda120_ (Block33Data* _data33_, gint keycode);
static gboolean ___lambda120__sdx_input_processor_input_processor_key_down (gint keycode, gpointer self);
SdxInputProcessor* sdx_input_processor_SetKeyUp (SdxInputProcessor* self, SdxInputProcessorInputProcessorKeyUp keyUp, void* keyUp_target);
static gboolean __lambda121_ (Block33Data* _data33_, gint keycode);
static gboolean ___lambda121__sdx_input_processor_input_processor_key_up (gint keycode, gpointer self);
SdxInputProcessor* sdx_input_processor_SetTouchDown (SdxInputProcessor* self, SdxInputProcessorInputProcessorTouchDown touchDown, void* touchDown_target);
static gboolean __lambda122_ (Block33Data* _data33_, gint screenX, gint screenY, gint pointer, gint button);
static gboolean ___lambda122__sdx_input_processor_input_processor_touch_down (gint x, gint y, gint pointer, gint button, gpointer self);
SdxInputProcessor* sdx_input_processor_SetTouchUp (SdxInputProcessor* self, SdxInputProcessorInputProcessorTouchUp touchUp, void* touchUp_target);
static gboolean __lambda123_ (Block33Data* _data33_, gint screenX, gint screenY, gint pointer, gint button);
static gboolean ___lambda123__sdx_input_processor_input_processor_touch_up (gint x, gint y, gint pointer, gint button, gpointer self);
SdxInputProcessor* sdx_input_processor_SetTouchDragged (SdxInputProcessor* self, SdxInputProcessorInputProcessorTouchDragged touchDragged, void* touchDragged_target);
static gboolean __lambda124_ (Block33Data* _data33_, gint screenX, gint screenY, gint pointer);
static gboolean ___lambda124__sdx_input_processor_input_processor_touch_dragged (gint x, gint y, gint pointer, gpointer self);
SdxInputProcessor* sdx_input_processor_SetMouseMoved (SdxInputProcessor* self, SdxInputProcessorInputProcessorMouseMoved mouseMoved, void* mouseMoved_target);
static gboolean __lambda125_ (Block33Data* _data33_, gint screenX, gint screenY);
static gboolean ___lambda125__sdx_input_processor_input_processor_mouse_moved (gint x, gint y, gpointer self);


static gpointer _entitas_world_retain0 (gpointer self) {
	return self ? entitas_world_retain (self) : NULL;
}


static Block33Data* block33_data_ref (Block33Data* _data33_) {
	g_atomic_int_inc (&_data33_->_ref_count_);
	return _data33_;
}


static void block33_data_unref (void * _userdata_) {
	Block33Data* _data33_;
	_data33_ = (Block33Data*) _userdata_;
	if (g_atomic_int_dec_and_test (&_data33_->_ref_count_)) {
		SystemsInputSystem* self;
		self = _data33_->self;
		_entitas_group_release0 (_data33_->player);
		_entitas_world_release0 (_data33_->world);
		_entitas_system_release0 (self);
		g_slice_free (Block33Data, _data33_);
	}
}


static void __lambda119_ (Block33Data* _data33_, gfloat delta) {
	SystemsInputSystem* self;
	EntitasEntity* _tmp0_;
	gboolean _tmp1_ = FALSE;
	self = _data33_->self;
	_tmp0_ = entitas_group_GetSingleEntity (_data33_->player);
	entitas_entity_SetPosition (_tmp0_, (gfloat) _data33_->x, (gfloat) _data33_->y);
	if (_data33_->shoot) {
		_tmp1_ = TRUE;
	} else {
		_tmp1_ = _data33_->mouseDown;
	}
	if (_tmp1_) {
		gfloat _tmp2_;
		_tmp2_ = delta;
		_data33_->timeToFire = _data33_->timeToFire - _tmp2_;
	}
	if (_data33_->timeToFire < ((gfloat) 0)) {
		Factory* _tmp3_;
		Factory* _tmp4_;
		_tmp3_ = _data33_->world;
		factory_AddBullet (_tmp3_, _data33_->x + 27, _data33_->y + 2);
		_tmp4_ = _data33_->world;
		factory_AddBullet (_tmp4_, _data33_->x - 27, _data33_->y + 2);
		_data33_->timeToFire = SYSTEMS_INPUT_SYSTEM_FIRE_RATE;
	}
}


static void ___lambda119__entitas_system_execute (gfloat delta, gpointer self) {
	__lambda119_ (self, delta);
}


static gboolean __lambda120_ (Block33Data* _data33_, gint keycode) {
	SystemsInputSystem* self;
	gboolean result = FALSE;
	gint _tmp0_;
	self = _data33_->self;
	_tmp0_ = keycode;
	if (_tmp0_ == ((gint) SDLK_z)) {
		_data33_->shoot = TRUE;
	}
	result = FALSE;
	return result;
}


static gboolean ___lambda120__sdx_input_processor_input_processor_key_down (gint keycode, gpointer self) {
	gboolean result;
	result = __lambda120_ (self, keycode);
	return result;
}


static gboolean __lambda121_ (Block33Data* _data33_, gint keycode) {
	SystemsInputSystem* self;
	gboolean result = FALSE;
	gint _tmp0_;
	self = _data33_->self;
	_tmp0_ = keycode;
	if (_tmp0_ == ((gint) SDLK_z)) {
		_data33_->shoot = FALSE;
	}
	result = FALSE;
	return result;
}


static gboolean ___lambda121__sdx_input_processor_input_processor_key_up (gint keycode, gpointer self) {
	gboolean result;
	result = __lambda121_ (self, keycode);
	return result;
}


static gboolean __lambda122_ (Block33Data* _data33_, gint screenX, gint screenY, gint pointer, gint button) {
	SystemsInputSystem* self;
	gboolean result = FALSE;
	gint _tmp0_;
	gint _tmp1_;
	self = _data33_->self;
	_tmp0_ = screenX;
	_data33_->x = _tmp0_;
	_tmp1_ = screenY;
	_data33_->y = _tmp1_;
	_data33_->mouseDown = TRUE;
	result = FALSE;
	return result;
}


static gboolean ___lambda122__sdx_input_processor_input_processor_touch_down (gint x, gint y, gint pointer, gint button, gpointer self) {
	gboolean result;
	result = __lambda122_ (self, x, y, pointer, button);
	return result;
}


static gboolean __lambda123_ (Block33Data* _data33_, gint screenX, gint screenY, gint pointer, gint button) {
	SystemsInputSystem* self;
	gboolean result = FALSE;
	gint _tmp0_;
	gint _tmp1_;
	self = _data33_->self;
	_tmp0_ = screenX;
	_data33_->x = _tmp0_;
	_tmp1_ = screenY;
	_data33_->y = _tmp1_;
	_data33_->mouseDown = FALSE;
	result = FALSE;
	return result;
}


static gboolean ___lambda123__sdx_input_processor_input_processor_touch_up (gint x, gint y, gint pointer, gint button, gpointer self) {
	gboolean result;
	result = __lambda123_ (self, x, y, pointer, button);
	return result;
}


static gboolean __lambda124_ (Block33Data* _data33_, gint screenX, gint screenY, gint pointer) {
	SystemsInputSystem* self;
	gboolean result = FALSE;
	gint _tmp0_;
	gint _tmp1_;
	self = _data33_->self;
	_tmp0_ = screenX;
	_data33_->x = _tmp0_;
	_tmp1_ = screenY;
	_data33_->y = _tmp1_;
	result = FALSE;
	return result;
}


static gboolean ___lambda124__sdx_input_processor_input_processor_touch_dragged (gint x, gint y, gint pointer, gpointer self) {
	gboolean result;
	result = __lambda124_ (self, x, y, pointer);
	return result;
}


static gboolean __lambda125_ (Block33Data* _data33_, gint screenX, gint screenY) {
	SystemsInputSystem* self;
	gboolean result = FALSE;
	gint _tmp0_;
	gint _tmp1_;
	self = _data33_->self;
	_tmp0_ = screenX;
	_data33_->x = _tmp0_;
	_tmp1_ = screenY;
	_data33_->y = _tmp1_;
	result = FALSE;
	return result;
}


static gboolean ___lambda125__sdx_input_processor_input_processor_mouse_moved (gint x, gint y, gpointer self) {
	gboolean result;
	result = __lambda125_ (self, x, y);
	return result;
}


SystemsInputSystem* systems_input_system_new (Game* game, Factory* world) {
	SystemsInputSystem* self;
	Block33Data* _data33_;
	Factory* _tmp0_;
	Factory* _tmp1_;
	Factory* _tmp2_;
	gint* _tmp3_;
	gint* _tmp4_;
	gint _tmp4__length1;
	EntitasMatcher* _tmp5_;
	EntitasMatcher* _tmp6_;
	EntitasGroup* _tmp7_;
	EntitasGroup* _tmp8_;
	SdxInputProcessor* _tmp9_;
	SdxInputProcessor* _tmp10_;
	SdxInputProcessor* _tmp11_;
	SdxInputProcessor* _tmp12_;
	SdxInputProcessor* _tmp13_;
	SdxInputProcessor* _tmp14_;
	SdxInputProcessor* _tmp15_;
	SdxInputProcessor* _tmp16_;
	SdxInputProcessor* _tmp17_;
	SdxInputProcessor* _tmp18_;
	SdxInputProcessor* _tmp19_;
	SdxInputProcessor* _tmp20_;
	SdxInputProcessor* _tmp21_;
	SdxInputProcessor* _tmp22_;
	g_return_val_if_fail (game != NULL, NULL);
	g_return_val_if_fail (world != NULL, NULL);
	_data33_ = g_slice_new0 (Block33Data);
	_data33_->_ref_count_ = 1;
	_tmp0_ = world;
	_tmp1_ = _entitas_world_retain0 (_tmp0_);
	_entitas_world_release0 (_data33_->world);
	_data33_->world = _tmp1_;
	self = (SystemsInputSystem*) entitas_system_new ();
	_data33_->self = entitas_system_retain (self);
	_data33_->x = 0;
	_data33_->y = 0;
	_data33_->mouseDown = FALSE;
	_data33_->shoot = FALSE;
	_data33_->timeToFire = SYSTEMS_INPUT_SYSTEM_FIRE_RATE;
	_tmp2_ = _data33_->world;
	_tmp3_ = g_new0 (gint, 1);
	_tmp3_[0] = (gint) ENTITAS_COMPONENTS_PlayerComponent;
	_tmp4_ = _tmp3_;
	_tmp4__length1 = 1;
	_tmp5_ = entitas_matcher_AllOf (_tmp4_, 1);
	_tmp6_ = _tmp5_;
	_tmp7_ = entitas_world_GetGroup ((EntitasWorld*) _tmp2_, _tmp6_);
	_tmp8_ = _tmp7_;
	_entitas_matcher_release0 (_tmp6_);
	_tmp4_ = (g_free (_tmp4_), NULL);
	_data33_->player = _tmp8_;
	(((EntitasSystem*) self)->Execute_target_destroy_notify == NULL) ? NULL : (((EntitasSystem*) self)->Execute_target_destroy_notify (((EntitasSystem*) self)->Execute_target), NULL);
	((EntitasSystem*) self)->Execute = NULL;
	((EntitasSystem*) self)->Execute_target = NULL;
	((EntitasSystem*) self)->Execute_target_destroy_notify = NULL;
	((EntitasSystem*) self)->Execute = ___lambda119__entitas_system_execute;
	((EntitasSystem*) self)->Execute_target = block33_data_ref (_data33_);
	((EntitasSystem*) self)->Execute_target_destroy_notify = block33_data_unref;
	_tmp9_ = sdx_input_processor_new ();
	_tmp10_ = _tmp9_;
	_tmp11_ = sdx_input_processor_SetKeyDown (_tmp10_, ___lambda120__sdx_input_processor_input_processor_key_down, _data33_);
	_tmp12_ = _tmp11_;
	_tmp13_ = sdx_input_processor_SetKeyUp (_tmp12_, ___lambda121__sdx_input_processor_input_processor_key_up, _data33_);
	_tmp14_ = _tmp13_;
	_tmp15_ = sdx_input_processor_SetTouchDown (_tmp14_, ___lambda122__sdx_input_processor_input_processor_touch_down, _data33_);
	_tmp16_ = _tmp15_;
	_tmp17_ = sdx_input_processor_SetTouchUp (_tmp16_, ___lambda123__sdx_input_processor_input_processor_touch_up, _data33_);
	_tmp18_ = _tmp17_;
	_tmp19_ = sdx_input_processor_SetTouchDragged (_tmp18_, ___lambda124__sdx_input_processor_input_processor_touch_dragged, _data33_);
	_tmp20_ = _tmp19_;
	_tmp21_ = sdx_input_processor_SetMouseMoved (_tmp20_, ___lambda125__sdx_input_processor_input_processor_mouse_moved, _data33_);
	_tmp22_ = _tmp21_;
	sdx_AddInputProcessor (_tmp22_);
	_sdx_input_processor_release0 (_tmp22_);
	_sdx_input_processor_release0 (_tmp20_);
	_sdx_input_processor_release0 (_tmp18_);
	_sdx_input_processor_release0 (_tmp16_);
	_sdx_input_processor_release0 (_tmp14_);
	_sdx_input_processor_release0 (_tmp12_);
	_sdx_input_processor_release0 (_tmp10_);
	block33_data_unref (_data33_);
	_data33_ = NULL;
	return self;
}




