/** updated by adriac */
/* Camera.c generated by valac 0.36.4-dirty, the Vala compiler
 * generated from Camera.vala, do not modify */

/*[Adriac:Sdx.Graphics::Camera:SdxGraphicsCamera:sdx_graphics_camera]*/
/*[Adriac:Sdx.Graphics:Camera:FluidCamera:SdxGraphicsCameraFluidCamera:sdx_graphics_camera_fluidcamera]*/
/*[Adriac:Sdx.Graphics:Camera:InnerCamera:SdxGraphicsCameraInnerCamera:sdx_graphics_camera_innercamera]*/
/*[Adriac:Sdx.Graphics:Camera:SimpleCamera:SdxGraphicsCameraSimpleCamera:sdx_graphics_camera_simplecamera]*/
/* ******************************************************************************
 * Copyright 2017 darkoverlordofdata.
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *   http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 ******************************************************************************/

#include <glib.h>
#include <glib-object.h>
#include <float.h>
#include <math.h>

typedef struct _SdxGraphicsCamera SdxGraphicsCamera;

#define SDX_GRAPHICS_CAMERA_TYPE_KIND (sdx_graphics_camera_kind_get_type ())

#define SDX_MATH_TYPE_VECTOR2 (sdx_math_vector2_get_type ())
typedef struct _SdxMathVector2 SdxMathVector2;
typedef SdxGraphicsCamera SdxGraphicsCameraInnerCamera;
typedef SdxGraphicsCamera SdxGraphicsCameraFluidCamera;
typedef SdxGraphicsCamera SdxGraphicsCameraSimpleCamera;

typedef enum  {
	SDX_GRAPHICS_CAMERA_KIND_FluidCamera,
	SDX_GRAPHICS_CAMERA_KIND_InnerCamera,
	SDX_GRAPHICS_CAMERA_KIND_SimpleCamera
} SdxGraphicsCameraKind;

struct _SdxMathVector2 {
	gfloat x;
	gfloat y;
};

typedef void (*SdxGraphicsCameraCameraSetPosition) (SdxMathVector2* position, void* user_data);
struct _SdxGraphicsCamera {
	gint ref_count;
	SdxGraphicsCameraKind kind;
	SdxMathVector2 position;
	SdxGraphicsCameraCameraSetPosition SetPosition;
	gpointer SetPosition_target;
	GDestroyNotify SetPosition_target_destroy_notify;
};


extern gint sdx_width;

void sdx_graphics_camera_free (SdxGraphicsCamera * self);
GType sdx_graphics_camera_kind_get_type (void) G_GNUC_CONST;
GType sdx_math_vector2_get_type (void) G_GNUC_CONST;
SdxMathVector2* sdx_math_vector2_dup (const SdxMathVector2* self);
void sdx_math_vector2_free (SdxMathVector2* self);
static void sdx_graphics_camera_instance_init (SdxGraphicsCamera * self);
static void _sdx_graphics_camera_set_position_lambda39_ (SdxMathVector2* position);
static void __sdx_graphics_camera_set_position_lambda39__sdx_graphics_camera_camera_set_position (SdxMathVector2* position, gpointer self);
SdxGraphicsCamera* sdx_graphics_camera_retain (SdxGraphicsCamera* self);
void sdx_graphics_camera_release (SdxGraphicsCamera* self);
void sdx_graphics_camera_free (SdxGraphicsCamera* self);
SdxGraphicsCamera* sdx_graphics_camera_new (void);
SdxGraphicsCameraInnerCamera* sdx_graphics_camera_inner_camera_new (gfloat x, gfloat y);
static void __lambda40_ (SdxGraphicsCameraInnerCamera* self, SdxMathVector2* player);
gfloat sdx_math_Clamp (gfloat value, gfloat low, gfloat hi);
static void ___lambda40__sdx_graphics_camera_camera_set_position (SdxMathVector2* position, gpointer self);
SdxGraphicsCameraFluidCamera* sdx_graphics_camera_fluid_camera_new (gfloat x, gfloat y);
static void __lambda41_ (SdxGraphicsCameraFluidCamera* self, SdxMathVector2* player);
static void ___lambda41__sdx_graphics_camera_camera_set_position (SdxMathVector2* position, gpointer self);
SdxGraphicsCameraSimpleCamera* sdx_graphics_camera_simple_camera_new (gfloat x, gfloat y);
static void __lambda42_ (SdxGraphicsCameraSimpleCamera* self, SdxMathVector2* player);
static void ___lambda42__sdx_graphics_camera_camera_set_position (SdxMathVector2* position, gpointer self);


GType sdx_graphics_camera_kind_get_type (void) {
	static volatile gsize sdx_graphics_camera_kind_type_id__volatile = 0;
	if (g_once_init_enter (&sdx_graphics_camera_kind_type_id__volatile)) {
		static const GEnumValue values[] = {{SDX_GRAPHICS_CAMERA_KIND_FluidCamera, "SDX_GRAPHICS_CAMERA_KIND_FluidCamera", "fluidcamera"}, {SDX_GRAPHICS_CAMERA_KIND_InnerCamera, "SDX_GRAPHICS_CAMERA_KIND_InnerCamera", "innercamera"}, {SDX_GRAPHICS_CAMERA_KIND_SimpleCamera, "SDX_GRAPHICS_CAMERA_KIND_SimpleCamera", "simplecamera"}, {0, NULL, NULL}};
		GType sdx_graphics_camera_kind_type_id;
		sdx_graphics_camera_kind_type_id = g_enum_register_static ("SdxGraphicsCameraKind", values);
		g_once_init_leave (&sdx_graphics_camera_kind_type_id__volatile, sdx_graphics_camera_kind_type_id);
	}
	return sdx_graphics_camera_kind_type_id__volatile;
}


static void _sdx_graphics_camera_set_position_lambda39_ (SdxMathVector2* position) {
	g_return_if_fail (position != NULL);
}


static void __sdx_graphics_camera_set_position_lambda39__sdx_graphics_camera_camera_set_position (SdxMathVector2* position, gpointer self) {
	_sdx_graphics_camera_set_position_lambda39_ (position);
}


SdxGraphicsCamera* sdx_graphics_camera_retain (SdxGraphicsCamera* self) {
	SdxGraphicsCamera* result = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	g_atomic_int_add ((volatile gint *) (&self->ref_count), 1);
	result = self;
	return result;
}


void sdx_graphics_camera_release (SdxGraphicsCamera* self) {
	gboolean _tmp0_;
	g_return_if_fail (self != NULL);
	_tmp0_ = g_atomic_int_dec_and_test ((volatile gint *) (&self->ref_count));
	if (_tmp0_) {
		sdx_graphics_camera_free (self);
	}
}


SdxGraphicsCamera* sdx_graphics_camera_new (void) {
	SdxGraphicsCamera* self;
	self = g_slice_new0 (SdxGraphicsCamera);
	sdx_graphics_camera_instance_init (self);
	return self;
}


/**
             * InnerCamera
             * 
             */
static void __lambda40_ (SdxGraphicsCameraInnerCamera* self, SdxMathVector2* player) {
	gfloat area = 0.0F;
	SdxMathVector2 _tmp0_;
	gfloat _tmp1_;
	gint _tmp2_;
	SdxMathVector2 _tmp3_;
	gfloat _tmp4_;
	gfloat _tmp5_;
	SdxMathVector2 _tmp6_;
	gfloat _tmp7_;
	SdxMathVector2 _tmp8_ = {0};
	g_return_if_fail (player != NULL);
	_tmp0_ = *player;
	_tmp1_ = _tmp0_.x;
	_tmp2_ = sdx_width;
	area = _tmp1_ - (((gfloat) _tmp2_) / 2);
	_tmp3_ = ((SdxGraphicsCamera*) self)->position;
	_tmp4_ = _tmp3_.x;
	_tmp5_ = sdx_math_Clamp (_tmp4_, area - 100, area + 100);
	_tmp6_ = ((SdxGraphicsCamera*) self)->position;
	_tmp7_ = _tmp6_.y;
	_tmp8_.x = _tmp5_;
	_tmp8_.y = _tmp7_;
	((SdxGraphicsCamera*) self)->position = _tmp8_;
}


static void ___lambda40__sdx_graphics_camera_camera_set_position (SdxMathVector2* position, gpointer self) {
	__lambda40_ ((SdxGraphicsCameraInnerCamera*) self, position);
}


SdxGraphicsCameraInnerCamera* sdx_graphics_camera_inner_camera_new (gfloat x, gfloat y) {
	SdxGraphicsCameraInnerCamera* self;
	gfloat _tmp0_;
	gfloat _tmp1_;
	SdxMathVector2 _tmp2_ = {0};
	self = (SdxGraphicsCameraInnerCamera*) sdx_graphics_camera_new ();
	((SdxGraphicsCamera*) self)->kind = SDX_GRAPHICS_CAMERA_KIND_InnerCamera;
	_tmp0_ = x;
	_tmp1_ = y;
	_tmp2_.x = _tmp0_;
	_tmp2_.y = _tmp1_;
	((SdxGraphicsCamera*) self)->position = _tmp2_;
	(((SdxGraphicsCamera*) self)->SetPosition_target_destroy_notify == NULL) ? NULL : (((SdxGraphicsCamera*) self)->SetPosition_target_destroy_notify (((SdxGraphicsCamera*) self)->SetPosition_target), NULL);
	((SdxGraphicsCamera*) self)->SetPosition = NULL;
	((SdxGraphicsCamera*) self)->SetPosition_target = NULL;
	((SdxGraphicsCamera*) self)->SetPosition_target_destroy_notify = NULL;
	((SdxGraphicsCamera*) self)->SetPosition = ___lambda40__sdx_graphics_camera_camera_set_position;
	((SdxGraphicsCamera*) self)->SetPosition_target = sdx_graphics_camera_retain (self);
	((SdxGraphicsCamera*) self)->SetPosition_target_destroy_notify = sdx_graphics_camera_release;
	return self;
}


/**
             * FluidCamera
             * 
             */
static void __lambda41_ (SdxGraphicsCameraFluidCamera* self, SdxMathVector2* player) {
	gfloat dist = 0.0F;
	SdxMathVector2 _tmp0_;
	gfloat _tmp1_;
	SdxMathVector2 _tmp2_;
	gfloat _tmp3_;
	gint _tmp4_;
	gfloat _tmp5_;
	gfloat _tmp6_;
	SdxMathVector2 _tmp7_;
	gfloat _tmp8_;
	SdxMathVector2 _tmp9_ = {0};
	g_return_if_fail (player != NULL);
	_tmp0_ = ((SdxGraphicsCamera*) self)->position;
	_tmp1_ = _tmp0_.x;
	_tmp2_ = *player;
	_tmp3_ = _tmp2_.x;
	_tmp4_ = sdx_width;
	dist = (_tmp1_ - _tmp3_) + (((gfloat) _tmp4_) / 2);
	_tmp5_ = ((SdxGraphicsCamera*) self)->position.x;
	((SdxGraphicsCamera*) self)->position.x = _tmp5_ + ((-0.05f) * dist);
	_tmp6_ = ((SdxGraphicsCamera*) self)->position.x;
	_tmp7_ = ((SdxGraphicsCamera*) self)->position;
	_tmp8_ = _tmp7_.y;
	_tmp9_.x = _tmp6_;
	_tmp9_.y = _tmp8_;
	((SdxGraphicsCamera*) self)->position = _tmp9_;
}


static void ___lambda41__sdx_graphics_camera_camera_set_position (SdxMathVector2* position, gpointer self) {
	__lambda41_ ((SdxGraphicsCameraFluidCamera*) self, position);
}


SdxGraphicsCameraFluidCamera* sdx_graphics_camera_fluid_camera_new (gfloat x, gfloat y) {
	SdxGraphicsCameraFluidCamera* self;
	gfloat _tmp0_;
	gfloat _tmp1_;
	SdxMathVector2 _tmp2_ = {0};
	self = (SdxGraphicsCameraFluidCamera*) sdx_graphics_camera_new ();
	((SdxGraphicsCamera*) self)->kind = SDX_GRAPHICS_CAMERA_KIND_FluidCamera;
	_tmp0_ = x;
	_tmp1_ = y;
	_tmp2_.x = _tmp0_;
	_tmp2_.y = _tmp1_;
	((SdxGraphicsCamera*) self)->position = _tmp2_;
	(((SdxGraphicsCamera*) self)->SetPosition_target_destroy_notify == NULL) ? NULL : (((SdxGraphicsCamera*) self)->SetPosition_target_destroy_notify (((SdxGraphicsCamera*) self)->SetPosition_target), NULL);
	((SdxGraphicsCamera*) self)->SetPosition = NULL;
	((SdxGraphicsCamera*) self)->SetPosition_target = NULL;
	((SdxGraphicsCamera*) self)->SetPosition_target_destroy_notify = NULL;
	((SdxGraphicsCamera*) self)->SetPosition = ___lambda41__sdx_graphics_camera_camera_set_position;
	((SdxGraphicsCamera*) self)->SetPosition_target = sdx_graphics_camera_retain (self);
	((SdxGraphicsCamera*) self)->SetPosition_target_destroy_notify = sdx_graphics_camera_release;
	return self;
}


/**
             * SimpleCamera
             * 
             */
static void __lambda42_ (SdxGraphicsCameraSimpleCamera* self, SdxMathVector2* player) {
	SdxMathVector2 _tmp0_;
	gfloat _tmp1_;
	gint _tmp2_;
	SdxMathVector2 _tmp3_;
	gfloat _tmp4_;
	SdxMathVector2 _tmp5_ = {0};
	g_return_if_fail (player != NULL);
	_tmp0_ = *player;
	_tmp1_ = _tmp0_.x;
	_tmp2_ = sdx_width;
	_tmp3_ = ((SdxGraphicsCamera*) self)->position;
	_tmp4_ = _tmp3_.y;
	_tmp5_.x = _tmp1_ - (((gfloat) _tmp2_) / 2);
	_tmp5_.y = _tmp4_;
	((SdxGraphicsCamera*) self)->position = _tmp5_;
}


static void ___lambda42__sdx_graphics_camera_camera_set_position (SdxMathVector2* position, gpointer self) {
	__lambda42_ ((SdxGraphicsCameraSimpleCamera*) self, position);
}


SdxGraphicsCameraSimpleCamera* sdx_graphics_camera_simple_camera_new (gfloat x, gfloat y) {
	SdxGraphicsCameraSimpleCamera* self;
	gfloat _tmp0_;
	gfloat _tmp1_;
	SdxMathVector2 _tmp2_ = {0};
	self = (SdxGraphicsCameraSimpleCamera*) sdx_graphics_camera_new ();
	((SdxGraphicsCamera*) self)->kind = SDX_GRAPHICS_CAMERA_KIND_SimpleCamera;
	_tmp0_ = x;
	_tmp1_ = y;
	_tmp2_.x = _tmp0_;
	_tmp2_.y = _tmp1_;
	((SdxGraphicsCamera*) self)->position = _tmp2_;
	(((SdxGraphicsCamera*) self)->SetPosition_target_destroy_notify == NULL) ? NULL : (((SdxGraphicsCamera*) self)->SetPosition_target_destroy_notify (((SdxGraphicsCamera*) self)->SetPosition_target), NULL);
	((SdxGraphicsCamera*) self)->SetPosition = NULL;
	((SdxGraphicsCamera*) self)->SetPosition_target = NULL;
	((SdxGraphicsCamera*) self)->SetPosition_target_destroy_notify = NULL;
	((SdxGraphicsCamera*) self)->SetPosition = ___lambda42__sdx_graphics_camera_camera_set_position;
	((SdxGraphicsCamera*) self)->SetPosition_target = sdx_graphics_camera_retain (self);
	((SdxGraphicsCamera*) self)->SetPosition_target_destroy_notify = sdx_graphics_camera_release;
	return self;
}


static void sdx_graphics_camera_instance_init (SdxGraphicsCamera * self) {
	self->ref_count = 1;
	self->SetPosition = __sdx_graphics_camera_set_position_lambda39__sdx_graphics_camera_camera_set_position;
	self->SetPosition_target = self;
	self->SetPosition_target_destroy_notify = NULL;
}


void sdx_graphics_camera_free (SdxGraphicsCamera * self) {
	(self->SetPosition_target_destroy_notify == NULL) ? NULL : (self->SetPosition_target_destroy_notify (self->SetPosition_target), NULL);
	self->SetPosition = NULL;
	self->SetPosition_target = NULL;
	self->SetPosition_target_destroy_notify = NULL;
	g_slice_free (SdxGraphicsCamera, self);
}




