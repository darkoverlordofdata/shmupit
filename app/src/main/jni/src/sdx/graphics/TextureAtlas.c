/** updated by adriac */
/* TextureAtlas.c generated by valac 0.36.4-dirty, the Vala compiler
 * generated from TextureAtlas.vala, do not modify */

/*[Adriac:Sdx.Graphics::AtlasRegion:SdxGraphicsAtlasRegion:sdx_graphics_atlas_region]*/
/*[Adriac:Sdx.Graphics::Page:SdxGraphicsPage:sdx_graphics_page]*/
/*[Adriac:Sdx.Graphics::TextureAtlasData:SdxGraphicsTextureAtlasData:sdx_graphics_texture_atlas_data]*/
/*[Adriac:Sdx.Graphics::Region:SdxGraphicsRegion:sdx_graphics_region]*/
/*[Adriac:Sdx.Graphics::TextureAtlas:SdxGraphicsTextureAtlas:sdx_graphics_texture_atlas]*/
/* ******************************************************************************
 * Copyright 2017 darkoverlordofdata.
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *   http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 ******************************************************************************/

#include <glib.h>
#include <glib-object.h>
#include <stdlib.h>
#include <string.h>
#include <float.h>
#include <math.h>
#include <SDL_pixels.h>

typedef struct _SdxGraphicsTextureAtlas SdxGraphicsTextureAtlas;
typedef struct _SdxGraphicsTextureRegion SdxGraphicsTextureRegion;
typedef SdxGraphicsTextureRegion SdxGraphicsTextureRegionFromTexture;
typedef SdxGraphicsTextureRegionFromTexture SdxGraphicsAtlasRegion;
#define __g_list_free__sdx_graphics_texture_region_release0_0(var) ((var == NULL) ? NULL : (var = (_g_list_free__sdx_graphics_texture_region_release0_ (var), NULL)))
typedef struct _SdxFilesFileHandle SdxFilesFileHandle;
// symtbl.1 sdx_files_file_handle
void sdx_files_file_handle_release (SdxFilesFileHandle* self);
void sdx_files_file_handle_free (SdxFilesFileHandle* self);
SdxFilesFileHandle* sdx_files_file_handle_retain (SdxFilesFileHandle* self);
#define _sdx_files_file_handle_release0(var) ((var == NULL) ? NULL : (var = (sdx_files_file_handle_release (var), NULL)))
typedef struct _SdxGraphicsTextureAtlasData SdxGraphicsTextureAtlasData;
// symtbl.1 sdx_graphics_texture_atlas_data
void sdx_graphics_texture_atlas_data_release (SdxGraphicsTextureAtlasData* self);
void sdx_graphics_texture_atlas_data_free (SdxGraphicsTextureAtlasData* self);
SdxGraphicsTextureAtlasData* sdx_graphics_texture_atlas_data_retain (SdxGraphicsTextureAtlasData* self);
#define _sdx_graphics_texture_atlas_data_release0(var) ((var == NULL) ? NULL : (var = (sdx_graphics_texture_atlas_data_release (var), NULL)))
typedef struct _SdxGraphicsSurface SdxGraphicsSurface;
typedef SdxGraphicsSurface SdxGraphicsSurfaceTextureSurface;
// symtbl.1 sdx_graphics_texture_region
void sdx_graphics_texture_region_release (SdxGraphicsTextureRegion* self);
void sdx_graphics_texture_region_free (SdxGraphicsTextureRegion* self);
SdxGraphicsTextureRegion* sdx_graphics_texture_region_retain (SdxGraphicsTextureRegion* self);
#define _sdx_graphics_texture_region_release0(var) ((var == NULL) ? NULL : (var = (sdx_graphics_texture_region_release (var), NULL)))
typedef struct _SdxGraphicsSprite SdxGraphicsSprite;
typedef SdxGraphicsSprite SdxGraphicsSpriteAtlasSprite;
typedef struct _SdxFont SdxFont;
typedef struct _SdxGraphicsNinePatch SdxGraphicsNinePatch;
typedef SdxGraphicsSprite SdxGraphicsSpriteUISprite;
// symtbl.1 sdx_graphics_nine_patch
void sdx_graphics_nine_patch_release (SdxGraphicsNinePatch* self);
void sdx_graphics_nine_patch_free (SdxGraphicsNinePatch* self);
SdxGraphicsNinePatch* sdx_graphics_nine_patch_retain (SdxGraphicsNinePatch* self);
#define _sdx_graphics_nine_patch_release0(var) ((var == NULL) ? NULL : (var = (sdx_graphics_nine_patch_release (var), NULL)))
#define _g_free0(var) (var = (g_free (var), NULL))
typedef struct _SdxGraphicsPage SdxGraphicsPage;
typedef struct _SdxGraphicsRegion SdxGraphicsRegion;

#define SDX_GRAPHICS_TYPE_FORMAT (sdx_graphics_format_get_type ())
// symtbl.1 sdx_graphics_surface
void sdx_graphics_surface_release (SdxGraphicsSurface* self);
void sdx_graphics_surface_free (SdxGraphicsSurface* self);
SdxGraphicsSurface* sdx_graphics_surface_retain (SdxGraphicsSurface* self);
#define _sdx_graphics_surface_release0(var) ((var == NULL) ? NULL : (var = (sdx_graphics_surface_release (var), NULL)))
// symtbl.1 sdx_graphics_page
void sdx_graphics_page_release (SdxGraphicsPage* self);
void sdx_graphics_page_free (SdxGraphicsPage* self);
SdxGraphicsPage* sdx_graphics_page_retain (SdxGraphicsPage* self);
#define _sdx_graphics_page_release0(var) ((var == NULL) ? NULL : (var = (sdx_graphics_page_release (var), NULL)))
// symtbl.1 sdx_graphics_region
void sdx_graphics_region_release (SdxGraphicsRegion* self);
void sdx_graphics_region_free (SdxGraphicsRegion* self);
SdxGraphicsRegion* sdx_graphics_region_retain (SdxGraphicsRegion* self);
#define _sdx_graphics_region_release0(var) ((var == NULL) ? NULL : (var = (sdx_graphics_region_release (var), NULL)))
#define __g_list_free__sdx_graphics_page_release0_0(var) ((var == NULL) ? NULL : (var = (_g_list_free__sdx_graphics_page_release0_ (var), NULL)))
#define __g_list_free__sdx_graphics_region_release0_0(var) ((var == NULL) ? NULL : (var = (_g_list_free__sdx_graphics_region_release0_ (var), NULL)))
typedef struct _SdxDataInputStream SdxDataInputStream;

#define SDX_GRAPHICS_TYPE_TEXTURE_FILTER (sdx_graphics_texture_filter_get_type ())

#define SDX_GRAPHICS_TYPE_TEXTURE_WRAP (sdx_graphics_texture_wrap_get_type ())
#define _g_error_free0(var) ((var == NULL) ? NULL : (var = (g_error_free (var), NULL)))
// symtbl.1 sdx_data_input_stream
void sdx_data_input_stream_release (SdxDataInputStream* self);
void sdx_data_input_stream_free (SdxDataInputStream* self);
SdxDataInputStream* sdx_data_input_stream_retain (SdxDataInputStream* self);
#define _sdx_data_input_stream_release0(var) ((var == NULL) ? NULL : (var = (sdx_data_input_stream_release (var), NULL)))

struct _SdxGraphicsTextureAtlas {
	gint ref_count;
	GList* regions;
};

struct _SdxGraphicsTextureRegion {
	gint ref_count;
	SdxGraphicsSurfaceTextureSurface* texture;
	gint top;
	gint left;
	gint width;
	gint height;
	gint regionWidth;
	gint regionHeight;
	gfloat u;
	gfloat v;
	gfloat u2;
	gfloat v2;
	gint index;
	gchar* name;
	gint offsetX;
	gint offsetY;
	gint packedWidth;
	gint packedHeight;
	gint originalWidth;
	gint originalHeight;
	gboolean rotate;
	gint* splits;
	gint splits_length1;
	gint* pads;
	gint pads_length1;
};

typedef enum  {
	SDX_SDL_EXCEPTION_Initialization,
	SDX_SDL_EXCEPTION_ImageInitialization,
	SDX_SDL_EXCEPTION_TtfInitialization,
	SDX_SDL_EXCEPTION_TextureFilteringNotEnabled,
	SDX_SDL_EXCEPTION_OpenWindow,
	SDX_SDL_EXCEPTION_CreateRenderer,
	SDX_SDL_EXCEPTION_InvalidForPlatform,
	SDX_SDL_EXCEPTION_UnableToLoadResource,
	SDX_SDL_EXCEPTION_UnableToLoadSurface,
	SDX_SDL_EXCEPTION_UnableToLoadTexture,
	SDX_SDL_EXCEPTION_NullPointer,
	SDX_SDL_EXCEPTION_NoSuchElement,
	SDX_SDL_EXCEPTION_IllegalStateException,
	SDX_SDL_EXCEPTION_IllegalArgumentException,
	SDX_SDL_EXCEPTION_RuntimeException,
	SDX_SDL_EXCEPTION_NotReached
} SdxSdlException;
#define SDX_SDL_EXCEPTION sdx_sdl_exception_quark ()
struct _SdxGraphicsTextureAtlasData {
	gint ref_count;
	GList* pages;
	GList* regions;
};

typedef enum  {
	SDX_GRAPHICS_FORMAT_Alpha,
	SDX_GRAPHICS_FORMAT_Intensity,
	SDX_GRAPHICS_FORMAT_LuminanceAlpha,
	SDX_GRAPHICS_FORMAT_RGB565,
	SDX_GRAPHICS_FORMAT_RGBA4444,
	SDX_GRAPHICS_FORMAT_RGB888,
	SDX_GRAPHICS_FORMAT_RGBA8888
} SdxGraphicsFormat;

struct _SdxGraphicsPage {
	gint ref_count;
	gint id;
	SdxFilesFileHandle* textureFile;
	SdxGraphicsSurfaceTextureSurface* texture;
	gint height;
	gint width;
	gboolean useMipMaps;
	SdxGraphicsFormat format;
	gint minFilter;
	gint magFilter;
	gint uWrap;
	gint vWrap;
};

struct _SdxGraphicsRegion {
	gint ref_count;
	SdxGraphicsPage* page;
	gint index;
	gchar* name;
	gint offsetX;
	gint offsetY;
	gint originalWidth;
	gint originalHeight;
	gboolean rotate;
	gint left;
	gint top;
	gint width;
	gint height;
	gboolean flip;
	gint* splits;
	gint splits_length1;
	gint* pads;
	gint pads_length1;
	gboolean slice9;
};

typedef enum  {
	SDX_IO_EXCEPTION_InvalidData
} SdxIOException;
#define SDX_IO_EXCEPTION sdx_io_exception_quark ()
typedef enum  {
	SDX_GRAPHICS_TEXTURE_FILTER_Nearest,
	SDX_GRAPHICS_TEXTURE_FILTER_Linear,
	SDX_GRAPHICS_TEXTURE_FILTER_MipMap,
	SDX_GRAPHICS_TEXTURE_FILTER_MipMapNearestNearest,
	SDX_GRAPHICS_TEXTURE_FILTER_MipMapLinearNearest,
	SDX_GRAPHICS_TEXTURE_FILTER_MipMapNearestLinear,
	SDX_GRAPHICS_TEXTURE_FILTER_MipMapLinearLinear
} SdxGraphicsTextureFilter;

typedef enum  {
	SDX_GRAPHICS_TEXTURE_WRAP_ClampToEdge = 1,
	SDX_GRAPHICS_TEXTURE_WRAP_Repeat = 2
} SdxGraphicsTextureWrap;


extern gint sdx_graphics_page_uniqueId;
gint sdx_graphics_page_uniqueId = 0;
extern SdxGraphicsTextureAtlasData* sdx_graphics_texture_atlas_data_instance;
SdxGraphicsTextureAtlasData* sdx_graphics_texture_atlas_data_instance = NULL;
extern gchar** sdx_graphics_texture_atlas_data_tuple;
extern gint sdx_graphics_texture_atlas_data_tuple_length1;
gchar** sdx_graphics_texture_atlas_data_tuple = NULL;
gint sdx_graphics_texture_atlas_data_tuple_length1 = 0;

void sdx_graphics_texture_atlas_free (SdxGraphicsTextureAtlas * self);
void sdx_graphics_texture_region_free (SdxGraphicsTextureRegion * self);
static void sdx_graphics_texture_atlas_instance_init (SdxGraphicsTextureAtlas * self);
// symtbl.2 sdx_graphics_texture_region
void sdx_graphics_texture_region_release (SdxGraphicsTextureRegion* self);
void sdx_graphics_texture_region_free (SdxGraphicsTextureRegion* self);
SdxGraphicsTextureRegion* sdx_graphics_texture_region_retain (SdxGraphicsTextureRegion* self);
static void _sdx_graphics_texture_region_release0_ (gpointer var);
static void _g_list_free__sdx_graphics_texture_region_release0_ (GList* self);
SdxGraphicsTextureAtlas* sdx_graphics_texture_atlas_retain (SdxGraphicsTextureAtlas* self);
void sdx_graphics_texture_atlas_release (SdxGraphicsTextureAtlas* self);
void sdx_graphics_texture_atlas_free (SdxGraphicsTextureAtlas* self);
void sdx_files_file_handle_free (SdxFilesFileHandle * self);
SdxGraphicsTextureAtlas* sdx_graphics_texture_atlas_new (SdxFilesFileHandle* packFile, SdxFilesFileHandle* imageDir, gboolean flip);
SdxFilesFileHandle* sdx_files_file_handle_GetParent (SdxFilesFileHandle* self);
void sdx_graphics_texture_atlas_data_free (SdxGraphicsTextureAtlasData * self);
void sdx_graphics_texture_atlas_Load (SdxGraphicsTextureAtlas* self, SdxGraphicsTextureAtlasData* data);
SdxGraphicsTextureAtlasData* sdx_graphics_texture_atlas_data_new (SdxFilesFileHandle* packFile, SdxFilesFileHandle* imagesDir, gboolean flip);
SdxGraphicsAtlasRegion* sdx_graphics_texture_atlas_FindRegion (SdxGraphicsTextureAtlas* self, const gchar* name, gint index);
void sdx_graphics_surface_free (SdxGraphicsSurface * self);
void sdx_graphics_sprite_free (SdxGraphicsSprite * self);
SdxGraphicsSprite* sdx_graphics_texture_atlas_CreateSprite (SdxGraphicsTextureAtlas* self, const gchar* name, gint index);
SdxGraphicsSpriteAtlasSprite* sdx_graphics_sprite_atlas_sprite_new (SdxGraphicsAtlasRegion* region);
void sdx_font_free (SdxFont * self);
SdxGraphicsSprite* sdx_graphics_texture_atlas_CreateUI (SdxGraphicsTextureAtlas* self, const gchar* name, const gchar* text, SdxFont* font, SDL_Color color, gint width, gint height);
void sdx_graphics_nine_patch_free (SdxGraphicsNinePatch * self);
SdxGraphicsNinePatch* sdx_graphics_texture_atlas_CreatePatch (SdxGraphicsTextureAtlas* self, const gchar* name);
SdxGraphicsSpriteUISprite* sdx_graphics_sprite_ui_sprite_new (SdxGraphicsNinePatch* patch, const gchar* text, SdxFont* font, SDL_Color color, gint width, gint height);
static gint* _vala_array_dup3 (gint* self, int length);
GQuark sdx_sdl_exception_quark (void);
SdxGraphicsNinePatch* sdx_graphics_nine_patch_new (SdxGraphicsTextureRegion* region, gint left, gint right, gint top, gint bottom);
void sdx_graphics_page_free (SdxGraphicsPage * self);
void sdx_graphics_region_free (SdxGraphicsRegion * self);
GType sdx_graphics_format_get_type (void) G_GNUC_CONST;
SdxGraphicsSurfaceTextureSurface* sdx_graphics_surface_texture_surface_new (SdxFilesFileHandle* file);
void sdx_graphics_surface_texture_surface_SetFilter (SdxGraphicsSurfaceTextureSurface* self, gint minFilter, gint magFilter);
void sdx_graphics_surface_texture_surface_SetWrap (SdxGraphicsSurfaceTextureSurface* self, gint u, gint v);
static void _vala_array_add8 (SdxGraphicsSurfaceTextureSurface** * array, int* length, int* size, SdxGraphicsSurfaceTextureSurface* value);
SdxGraphicsAtlasRegion* sdx_graphics_atlas_region_new (SdxGraphicsSurfaceTextureSurface* texture, gint x, gint y, gint width, gint height);
static gint* _vala_array_dup4 (gint* self, int length);
static gint* _vala_array_dup5 (gint* self, int length);
void sdx_graphics_texture_region_Flip (SdxGraphicsTextureRegion* self, gboolean x, gboolean y);
SdxGraphicsTextureRegionFromTexture* sdx_graphics_texture_region_from_texture_new (SdxGraphicsSurfaceTextureSurface* texture, gint x, gint y, gint width, gint height);
static void sdx_graphics_page_instance_init (SdxGraphicsPage * self);
SdxGraphicsPage* sdx_graphics_page_retain (SdxGraphicsPage* self);
void sdx_graphics_page_release (SdxGraphicsPage* self);
void sdx_graphics_page_free (SdxGraphicsPage* self);
SdxGraphicsPage* sdx_graphics_page_new (SdxFilesFileHandle* handle, gint width, gint height, gboolean useMipMaps, SdxGraphicsFormat format, gint minFilter, gint magFilter, gint uWrap, gint vWrap);
static void sdx_graphics_region_instance_init (SdxGraphicsRegion * self);
SdxGraphicsRegion* sdx_graphics_region_retain (SdxGraphicsRegion* self);
void sdx_graphics_region_release (SdxGraphicsRegion* self);
void sdx_graphics_region_free (SdxGraphicsRegion* self);
SdxGraphicsRegion* sdx_graphics_region_new (SdxGraphicsPage* page, gint left, gint top, gint width, gint height, const gchar* name, gboolean rotatate);
static void sdx_graphics_texture_atlas_data_instance_init (SdxGraphicsTextureAtlasData * self);
// symtbl.2 sdx_graphics_page
void sdx_graphics_page_release (SdxGraphicsPage* self);
void sdx_graphics_page_free (SdxGraphicsPage* self);
SdxGraphicsPage* sdx_graphics_page_retain (SdxGraphicsPage* self);
static void _sdx_graphics_page_release0_ (gpointer var);
static void _g_list_free__sdx_graphics_page_release0_ (GList* self);
// symtbl.2 sdx_graphics_region
void sdx_graphics_region_release (SdxGraphicsRegion* self);
void sdx_graphics_region_free (SdxGraphicsRegion* self);
SdxGraphicsRegion* sdx_graphics_region_retain (SdxGraphicsRegion* self);
static void _sdx_graphics_region_release0_ (gpointer var);
static void _g_list_free__sdx_graphics_region_release0_ (GList* self);
SdxGraphicsTextureAtlasData* sdx_graphics_texture_atlas_data_retain (SdxGraphicsTextureAtlasData* self);
void sdx_graphics_texture_atlas_data_release (SdxGraphicsTextureAtlasData* self);
void sdx_graphics_texture_atlas_data_free (SdxGraphicsTextureAtlasData* self);
void sdx_data_input_stream_free (SdxDataInputStream * self);
gint sdx_graphics_texture_atlas_data_ReadTuple (SdxDataInputStream* reader);
gchar* sdx_data_input_stream_ReadLine (SdxDataInputStream* self);
GQuark sdx_io_exception_quark (void);
gchar* sdx_graphics_texture_atlas_data_ReadValue (SdxDataInputStream* reader);
gchar* sdx_files_file_handle_Read (SdxFilesFileHandle* self);
SdxDataInputStream* sdx_data_input_stream_new (const gchar* data);
SdxFilesFileHandle* sdx_files_file_handle_Child (SdxFilesFileHandle* self, const gchar* name);
SdxGraphicsFormat sdx_graphics_format_from (const gchar* value);
GType sdx_graphics_texture_filter_get_type (void) G_GNUC_CONST;
SdxGraphicsTextureFilter sdx_graphics_texture_filter_from (const gchar* value);
GType sdx_graphics_texture_wrap_get_type (void) G_GNUC_CONST;
gboolean sdx_graphics_texture_filter_isMipMap (SdxGraphicsTextureFilter self);
static void _vala_array_destroy (gpointer array, gint array_length, GDestroyNotify destroy_func);
static void _vala_array_free (gpointer array, gint array_length, GDestroyNotify destroy_func);
static gint _vala_array_length (gpointer array);


// symtbl.2 sdx_graphics_texture_region
void sdx_graphics_texture_region_release (SdxGraphicsTextureRegion* self);
void sdx_graphics_texture_region_free (SdxGraphicsTextureRegion* self);
SdxGraphicsTextureRegion* sdx_graphics_texture_region_retain (SdxGraphicsTextureRegion* self);
static void _sdx_graphics_texture_region_release0_ (gpointer var) {
	(var == NULL) ? NULL : (var = (sdx_graphics_texture_region_release (var), NULL));
}


static void _g_list_free__sdx_graphics_texture_region_release0_ (GList* self) {
	g_list_foreach (self, (GFunc) _sdx_graphics_texture_region_release0_, NULL);
	g_list_free (self);
}


SdxGraphicsTextureAtlas* sdx_graphics_texture_atlas_retain (SdxGraphicsTextureAtlas* self) {
	SdxGraphicsTextureAtlas* result = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	g_atomic_int_add ((volatile gint *) (&self->ref_count), 1);
	result = self;
	return result;
}


void sdx_graphics_texture_atlas_release (SdxGraphicsTextureAtlas* self) {
	gboolean _tmp0_;
	g_return_if_fail (self != NULL);
	_tmp0_ = g_atomic_int_dec_and_test ((volatile gint *) (&self->ref_count));
	if (_tmp0_) {
		sdx_graphics_texture_atlas_free (self);
	}
}


/**
         * @param packFile handle
         * @param imageDir handle
         * @param flip images?
         */
static gpointer _sdx_files_file_handle_retain0 (gpointer self) {
	return self ? sdx_files_file_handle_retain (self) : NULL;
}


SdxGraphicsTextureAtlas* sdx_graphics_texture_atlas_new (SdxFilesFileHandle* packFile, SdxFilesFileHandle* imageDir, gboolean flip) {
	SdxGraphicsTextureAtlas* self;
	SdxFilesFileHandle* _tmp0_ = NULL;
	SdxFilesFileHandle* _tmp1_;
	SdxFilesFileHandle* _tmp6_;
	gboolean _tmp7_;
	SdxGraphicsTextureAtlasData* _tmp8_;
	SdxGraphicsTextureAtlasData* _tmp9_;
	g_return_val_if_fail (packFile != NULL, NULL);
	self = g_slice_new0 (SdxGraphicsTextureAtlas);
	sdx_graphics_texture_atlas_instance_init (self);
	_tmp1_ = imageDir;
	if (_tmp1_ == NULL) {
		SdxFilesFileHandle* _tmp2_;
		SdxFilesFileHandle* _tmp3_;
		_tmp2_ = packFile;
		_tmp3_ = sdx_files_file_handle_GetParent (_tmp2_);
		_sdx_files_file_handle_release0 (_tmp0_);
		_tmp0_ = _tmp3_;
	} else {
		SdxFilesFileHandle* _tmp4_;
		SdxFilesFileHandle* _tmp5_;
		_tmp4_ = imageDir;
		_tmp5_ = _sdx_files_file_handle_retain0 (_tmp4_);
		_sdx_files_file_handle_release0 (_tmp0_);
		_tmp0_ = _tmp5_;
	}
	_tmp6_ = packFile;
	_tmp7_ = flip;
	_tmp8_ = sdx_graphics_texture_atlas_data_new (_tmp6_, _tmp0_, _tmp7_);
	_tmp9_ = _tmp8_;
	sdx_graphics_texture_atlas_Load (self, _tmp9_);
	_sdx_graphics_texture_atlas_data_release0 (_tmp9_);
	_sdx_files_file_handle_release0 (_tmp0_);
	return self;
}


static gpointer _sdx_graphics_texture_region_retain0 (gpointer self) {
	return self ? sdx_graphics_texture_region_retain (self) : NULL;
}


SdxGraphicsAtlasRegion* sdx_graphics_texture_atlas_FindRegion (SdxGraphicsTextureAtlas* self, const gchar* name, gint index) {
	SdxGraphicsAtlasRegion* result = NULL;
	GList* _tmp0_;
	g_return_val_if_fail (self != NULL, NULL);
	g_return_val_if_fail (name != NULL, NULL);
	_tmp0_ = self->regions;
	{
		GList* region_collection = NULL;
		GList* region_it = NULL;
		region_collection = _tmp0_;
		for (region_it = region_collection; region_it != NULL; region_it = region_it->next) {
			SdxGraphicsAtlasRegion* _tmp1_;
			SdxGraphicsAtlasRegion* region = NULL;
			_tmp1_ = _sdx_graphics_texture_region_retain0 ((SdxGraphicsAtlasRegion*) region_it->data);
			region = _tmp1_;
			{
				gint _tmp2_;
				_tmp2_ = index;
				if (_tmp2_ == -1) {
					SdxGraphicsAtlasRegion* _tmp3_;
					const gchar* _tmp4_;
					const gchar* _tmp5_;
					_tmp3_ = region;
					_tmp4_ = ((SdxGraphicsTextureRegion*) _tmp3_)->name;
					_tmp5_ = name;
					if (g_strcmp0 (_tmp4_, _tmp5_) == 0) {
						result = region;
						return result;
					}
				} else {
					gboolean _tmp6_ = FALSE;
					SdxGraphicsAtlasRegion* _tmp7_;
					const gchar* _tmp8_;
					const gchar* _tmp9_;
					_tmp7_ = region;
					_tmp8_ = ((SdxGraphicsTextureRegion*) _tmp7_)->name;
					_tmp9_ = name;
					if (g_strcmp0 (_tmp8_, _tmp9_) == 0) {
						SdxGraphicsAtlasRegion* _tmp10_;
						gint _tmp11_;
						gint _tmp12_;
						_tmp10_ = region;
						_tmp11_ = ((SdxGraphicsTextureRegion*) _tmp10_)->index;
						_tmp12_ = index;
						_tmp6_ = _tmp11_ == _tmp12_;
					} else {
						_tmp6_ = FALSE;
					}
					if (_tmp6_) {
						result = region;
						return result;
					}
				}
				_sdx_graphics_texture_region_release0 (region);
			}
		}
	}
	result = NULL;
	return result;
}


SdxGraphicsSprite* sdx_graphics_texture_atlas_CreateSprite (SdxGraphicsTextureAtlas* self, const gchar* name, gint index) {
	SdxGraphicsSprite* result = NULL;
	GList* _tmp0_;
	g_return_val_if_fail (self != NULL, NULL);
	g_return_val_if_fail (name != NULL, NULL);
	_tmp0_ = self->regions;
	{
		GList* region_collection = NULL;
		GList* region_it = NULL;
		region_collection = _tmp0_;
		for (region_it = region_collection; region_it != NULL; region_it = region_it->next) {
			SdxGraphicsAtlasRegion* _tmp1_;
			SdxGraphicsAtlasRegion* region = NULL;
			_tmp1_ = _sdx_graphics_texture_region_retain0 ((SdxGraphicsAtlasRegion*) region_it->data);
			region = _tmp1_;
			{
				gint _tmp2_;
				_tmp2_ = index;
				if (_tmp2_ == -1) {
					SdxGraphicsAtlasRegion* _tmp3_;
					const gchar* _tmp4_;
					const gchar* _tmp5_;
					_tmp3_ = region;
					_tmp4_ = ((SdxGraphicsTextureRegion*) _tmp3_)->name;
					_tmp5_ = name;
					if (g_strcmp0 (_tmp4_, _tmp5_) == 0) {
						SdxGraphicsAtlasRegion* _tmp6_;
						SdxGraphicsSpriteAtlasSprite* _tmp7_;
						_tmp6_ = region;
						_tmp7_ = sdx_graphics_sprite_atlas_sprite_new (_tmp6_);
						result = (SdxGraphicsSprite*) _tmp7_;
						_sdx_graphics_texture_region_release0 (region);
						return result;
					}
				} else {
					gboolean _tmp8_ = FALSE;
					SdxGraphicsAtlasRegion* _tmp9_;
					const gchar* _tmp10_;
					const gchar* _tmp11_;
					_tmp9_ = region;
					_tmp10_ = ((SdxGraphicsTextureRegion*) _tmp9_)->name;
					_tmp11_ = name;
					if (g_strcmp0 (_tmp10_, _tmp11_) == 0) {
						SdxGraphicsAtlasRegion* _tmp12_;
						gint _tmp13_;
						gint _tmp14_;
						_tmp12_ = region;
						_tmp13_ = ((SdxGraphicsTextureRegion*) _tmp12_)->index;
						_tmp14_ = index;
						_tmp8_ = _tmp13_ == _tmp14_;
					} else {
						_tmp8_ = FALSE;
					}
					if (_tmp8_) {
						SdxGraphicsAtlasRegion* _tmp15_;
						SdxGraphicsSpriteAtlasSprite* _tmp16_;
						_tmp15_ = region;
						_tmp16_ = sdx_graphics_sprite_atlas_sprite_new (_tmp15_);
						result = (SdxGraphicsSprite*) _tmp16_;
						_sdx_graphics_texture_region_release0 (region);
						return result;
					}
				}
				_sdx_graphics_texture_region_release0 (region);
			}
		}
	}
	result = NULL;
	return result;
}


SdxGraphicsSprite* sdx_graphics_texture_atlas_CreateUI (SdxGraphicsTextureAtlas* self, const gchar* name, const gchar* text, SdxFont* font, SDL_Color color, gint width, gint height) {
	SdxGraphicsSprite* result = NULL;
	const gchar* _tmp0_;
	SdxGraphicsNinePatch* _tmp1_;
	SdxGraphicsNinePatch* _tmp2_;
	const gchar* _tmp3_;
	SdxFont* _tmp4_;
	SDL_Color _tmp5_;
	gint _tmp6_;
	gint _tmp7_;
	SdxGraphicsSpriteUISprite* _tmp8_;
	SdxGraphicsSprite* _tmp9_;
	g_return_val_if_fail (self != NULL, NULL);
	g_return_val_if_fail (name != NULL, NULL);
	g_return_val_if_fail (text != NULL, NULL);
	g_return_val_if_fail (font != NULL, NULL);
	_tmp0_ = name;
	_tmp1_ = sdx_graphics_texture_atlas_CreatePatch (self, _tmp0_);
	_tmp2_ = _tmp1_;
	_tmp3_ = text;
	_tmp4_ = font;
	_tmp5_ = color;
	_tmp6_ = width;
	_tmp7_ = height;
	_tmp8_ = sdx_graphics_sprite_ui_sprite_new (_tmp2_, _tmp3_, _tmp4_, _tmp5_, _tmp6_, _tmp7_);
	_tmp9_ = (SdxGraphicsSprite*) _tmp8_;
	_sdx_graphics_nine_patch_release0 (_tmp2_);
	result = _tmp9_;
	return result;
}


static gint* _vala_array_dup3 (gint* self, int length) {
	return g_memdup (self, length * sizeof (gint));
}


SdxGraphicsNinePatch* sdx_graphics_texture_atlas_CreatePatch (SdxGraphicsTextureAtlas* self, const gchar* name) {
	SdxGraphicsNinePatch* result = NULL;
	GList* _tmp0_;
	GError * _inner_error_ = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	g_return_val_if_fail (name != NULL, NULL);
	_tmp0_ = self->regions;
	{
		GList* region_collection = NULL;
		GList* region_it = NULL;
		region_collection = _tmp0_;
		for (region_it = region_collection; region_it != NULL; region_it = region_it->next) {
			SdxGraphicsAtlasRegion* _tmp1_;
			SdxGraphicsAtlasRegion* region = NULL;
			_tmp1_ = _sdx_graphics_texture_region_retain0 ((SdxGraphicsAtlasRegion*) region_it->data);
			region = _tmp1_;
			{
				SdxGraphicsAtlasRegion* _tmp2_;
				const gchar* _tmp3_;
				const gchar* _tmp4_;
				_tmp2_ = region;
				_tmp3_ = ((SdxGraphicsTextureRegion*) _tmp2_)->name;
				_tmp4_ = name;
				if (g_strcmp0 (_tmp3_, _tmp4_) == 0) {
					gint* splits = NULL;
					SdxGraphicsAtlasRegion* _tmp5_;
					gint* _tmp6_;
					gint _tmp6__length1;
					gint* _tmp7_;
					gint _tmp7__length1;
					gint splits_length1;
					gint _splits_size_;
					gint* _tmp8_;
					gint _tmp8__length1;
					SdxGraphicsNinePatch* patch = NULL;
					SdxGraphicsAtlasRegion* _tmp14_;
					gint* _tmp15_;
					gint _tmp15__length1;
					gint _tmp16_;
					gint* _tmp17_;
					gint _tmp17__length1;
					gint _tmp18_;
					gint* _tmp19_;
					gint _tmp19__length1;
					gint _tmp20_;
					gint* _tmp21_;
					gint _tmp21__length1;
					gint _tmp22_;
					SdxGraphicsNinePatch* _tmp23_;
					_tmp5_ = region;
					_tmp6_ = ((SdxGraphicsTextureRegion*) _tmp5_)->splits;
					_tmp6__length1 = ((SdxGraphicsTextureRegion*) _tmp5_)->splits_length1;
					_tmp7_ = (_tmp6_ != NULL) ? _vala_array_dup3 (_tmp6_, _tmp6__length1) : ((gpointer) _tmp6_);
					_tmp7__length1 = _tmp6__length1;
					splits = _tmp7_;
					splits_length1 = _tmp7__length1;
					_splits_size_ = splits_length1;
					_tmp8_ = splits;
					_tmp8__length1 = splits_length1;
					if (_tmp8_ == NULL) {
						const gchar* _tmp9_;
						gchar* _tmp10_;
						gchar* _tmp11_;
						GError* _tmp12_;
						GError* _tmp13_;
						_tmp9_ = name;
						_tmp10_ = g_strconcat ("Region does not have ninepatch splits: ", _tmp9_, NULL);
						_tmp11_ = _tmp10_;
						_tmp12_ = g_error_new_literal (SDX_SDL_EXCEPTION, SDX_SDL_EXCEPTION_IllegalArgumentException, _tmp11_);
						_tmp13_ = _tmp12_;
						_g_free0 (_tmp11_);
						_inner_error_ = _tmp13_;
						splits = (g_free (splits), NULL);
						_sdx_graphics_texture_region_release0 (region);
						g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
						g_clear_error (&_inner_error_);
						return NULL;
					}
					_tmp14_ = region;
					_tmp15_ = splits;
					_tmp15__length1 = splits_length1;
					_tmp16_ = _tmp15_[0];
					_tmp17_ = splits;
					_tmp17__length1 = splits_length1;
					_tmp18_ = _tmp17_[1];
					_tmp19_ = splits;
					_tmp19__length1 = splits_length1;
					_tmp20_ = _tmp19_[2];
					_tmp21_ = splits;
					_tmp21__length1 = splits_length1;
					_tmp22_ = _tmp21_[3];
					_tmp23_ = sdx_graphics_nine_patch_new ((SdxGraphicsTextureRegion*) _tmp14_, _tmp16_, _tmp18_, _tmp20_, _tmp22_);
					patch = _tmp23_;
					result = patch;
					splits = (g_free (splits), NULL);
					_sdx_graphics_texture_region_release0 (region);
					return result;
				}
				_sdx_graphics_texture_region_release0 (region);
			}
		}
	}
	result = NULL;
	return result;
}


static gpointer _sdx_graphics_page_retain0 (gpointer self) {
	return self ? sdx_graphics_page_retain (self) : NULL;
}


static gpointer _sdx_graphics_surface_retain0 (gpointer self) {
	return self ? sdx_graphics_surface_retain (self) : NULL;
}


static void _vala_array_add8 (SdxGraphicsSurfaceTextureSurface** * array, int* length, int* size, SdxGraphicsSurfaceTextureSurface* value) {
	if ((*length) == (*size)) {
		*size = (*size) ? (2 * (*size)) : 4;
		*array = g_renew (SdxGraphicsSurfaceTextureSurface*, *array, (*size) + 1);
	}
	(*array)[(*length)++] = value;
	(*array)[*length] = NULL;
}


static gpointer _sdx_graphics_region_retain0 (gpointer self) {
	return self ? sdx_graphics_region_retain (self) : NULL;
}


static gint* _vala_array_dup4 (gint* self, int length) {
	return g_memdup (self, length * sizeof (gint));
}


static gint* _vala_array_dup5 (gint* self, int length) {
	return g_memdup (self, length * sizeof (gint));
}


void sdx_graphics_texture_atlas_Load (SdxGraphicsTextureAtlas* self, SdxGraphicsTextureAtlasData* data) {
	SdxGraphicsSurfaceTextureSurface* texture = NULL;
	SdxGraphicsSurfaceTextureSurface** pageToTexture = NULL;
	SdxGraphicsSurfaceTextureSurface** _tmp0_;
	gint pageToTexture_length1;
	gint _pageToTexture_size_;
	SdxGraphicsTextureAtlasData* _tmp1_;
	GList* _tmp2_;
	SdxGraphicsTextureAtlasData* _tmp25_;
	GList* _tmp26_;
	g_return_if_fail (self != NULL);
	g_return_if_fail (data != NULL);
	texture = NULL;
	_tmp0_ = g_new0 (SdxGraphicsSurfaceTextureSurface*, 0 + 1);
	pageToTexture = _tmp0_;
	pageToTexture_length1 = 0;
	_pageToTexture_size_ = pageToTexture_length1;
	_tmp1_ = data;
	_tmp2_ = _tmp1_->pages;
	{
		GList* page_collection = NULL;
		GList* page_it = NULL;
		page_collection = _tmp2_;
		for (page_it = page_collection; page_it != NULL; page_it = page_it->next) {
			SdxGraphicsPage* _tmp3_;
			SdxGraphicsPage* page = NULL;
			_tmp3_ = _sdx_graphics_page_retain0 ((SdxGraphicsPage*) page_it->data);
			page = _tmp3_;
			{
				SdxGraphicsPage* _tmp4_;
				SdxGraphicsSurfaceTextureSurface* _tmp5_;
				SdxGraphicsSurfaceTextureSurface* _tmp12_;
				SdxGraphicsPage* _tmp13_;
				gint _tmp14_;
				SdxGraphicsPage* _tmp15_;
				gint _tmp16_;
				SdxGraphicsSurfaceTextureSurface* _tmp17_;
				SdxGraphicsPage* _tmp18_;
				gint _tmp19_;
				SdxGraphicsPage* _tmp20_;
				gint _tmp21_;
				SdxGraphicsSurfaceTextureSurface** _tmp22_;
				gint _tmp22__length1;
				SdxGraphicsSurfaceTextureSurface* _tmp23_;
				SdxGraphicsSurfaceTextureSurface* _tmp24_;
				_tmp4_ = page;
				_tmp5_ = _tmp4_->texture;
				if (_tmp5_ == NULL) {
					SdxGraphicsPage* _tmp6_;
					SdxFilesFileHandle* _tmp7_;
					SdxGraphicsSurfaceTextureSurface* _tmp8_;
					_tmp6_ = page;
					_tmp7_ = _tmp6_->textureFile;
					_tmp8_ = sdx_graphics_surface_texture_surface_new (_tmp7_);
					_sdx_graphics_surface_release0 (texture);
					texture = _tmp8_;
				} else {
					SdxGraphicsPage* _tmp9_;
					SdxGraphicsSurfaceTextureSurface* _tmp10_;
					SdxGraphicsSurfaceTextureSurface* _tmp11_;
					_tmp9_ = page;
					_tmp10_ = _tmp9_->texture;
					_tmp11_ = _sdx_graphics_surface_retain0 (_tmp10_);
					_sdx_graphics_surface_release0 (texture);
					texture = _tmp11_;
				}
				_tmp12_ = texture;
				_tmp13_ = page;
				_tmp14_ = _tmp13_->minFilter;
				_tmp15_ = page;
				_tmp16_ = _tmp15_->magFilter;
				sdx_graphics_surface_texture_surface_SetFilter (_tmp12_, _tmp14_, _tmp16_);
				_tmp17_ = texture;
				_tmp18_ = page;
				_tmp19_ = _tmp18_->uWrap;
				_tmp20_ = page;
				_tmp21_ = _tmp20_->vWrap;
				sdx_graphics_surface_texture_surface_SetWrap (_tmp17_, _tmp19_, _tmp21_);
				_tmp22_ = pageToTexture;
				_tmp22__length1 = pageToTexture_length1;
				_tmp23_ = texture;
				_tmp24_ = _sdx_graphics_surface_retain0 (_tmp23_);
				_vala_array_add8 (&pageToTexture, &pageToTexture_length1, &_pageToTexture_size_, _tmp24_);
				_sdx_graphics_page_release0 (page);
			}
		}
	}
	_tmp25_ = data;
	_tmp26_ = _tmp25_->regions;
	{
		GList* region_collection = NULL;
		GList* region_it = NULL;
		region_collection = _tmp26_;
		for (region_it = region_collection; region_it != NULL; region_it = region_it->next) {
			SdxGraphicsRegion* _tmp27_;
			SdxGraphicsRegion* region = NULL;
			_tmp27_ = _sdx_graphics_region_retain0 ((SdxGraphicsRegion*) region_it->data);
			region = _tmp27_;
			{
				gint width = 0;
				SdxGraphicsRegion* _tmp28_;
				gint _tmp29_;
				gint height = 0;
				SdxGraphicsRegion* _tmp30_;
				gint _tmp31_;
				gint _tmp32_ = 0;
				SdxGraphicsRegion* _tmp33_;
				gboolean _tmp34_;
				gint _tmp37_ = 0;
				SdxGraphicsRegion* _tmp38_;
				gboolean _tmp39_;
				SdxGraphicsAtlasRegion* atlasRegion = NULL;
				SdxGraphicsSurfaceTextureSurface** _tmp42_;
				gint _tmp42__length1;
				SdxGraphicsRegion* _tmp43_;
				SdxGraphicsPage* _tmp44_;
				gint _tmp45_;
				SdxGraphicsSurfaceTextureSurface* _tmp46_;
				SdxGraphicsRegion* _tmp47_;
				gint _tmp48_;
				SdxGraphicsRegion* _tmp49_;
				gint _tmp50_;
				SdxGraphicsAtlasRegion* _tmp51_;
				SdxGraphicsAtlasRegion* _tmp52_;
				SdxGraphicsRegion* _tmp53_;
				gint _tmp54_;
				SdxGraphicsAtlasRegion* _tmp55_;
				SdxGraphicsRegion* _tmp56_;
				const gchar* _tmp57_;
				gchar* _tmp58_;
				SdxGraphicsAtlasRegion* _tmp59_;
				SdxGraphicsRegion* _tmp60_;
				gint _tmp61_;
				SdxGraphicsAtlasRegion* _tmp62_;
				SdxGraphicsRegion* _tmp63_;
				gint _tmp64_;
				SdxGraphicsAtlasRegion* _tmp65_;
				SdxGraphicsRegion* _tmp66_;
				gint _tmp67_;
				SdxGraphicsAtlasRegion* _tmp68_;
				SdxGraphicsRegion* _tmp69_;
				gint _tmp70_;
				SdxGraphicsAtlasRegion* _tmp71_;
				SdxGraphicsRegion* _tmp72_;
				gboolean _tmp73_;
				SdxGraphicsAtlasRegion* _tmp74_;
				SdxGraphicsRegion* _tmp75_;
				gint* _tmp76_;
				gint _tmp76__length1;
				gint* _tmp77_;
				gint _tmp77__length1;
				SdxGraphicsAtlasRegion* _tmp78_;
				SdxGraphicsRegion* _tmp79_;
				gint* _tmp80_;
				gint _tmp80__length1;
				gint* _tmp81_;
				gint _tmp81__length1;
				SdxGraphicsRegion* _tmp82_;
				gboolean _tmp83_;
				SdxGraphicsAtlasRegion* _tmp85_;
				SdxGraphicsAtlasRegion* _tmp86_;
				_tmp28_ = region;
				_tmp29_ = _tmp28_->width;
				width = _tmp29_;
				_tmp30_ = region;
				_tmp31_ = _tmp30_->height;
				height = _tmp31_;
				_tmp33_ = region;
				_tmp34_ = _tmp33_->rotate;
				if (_tmp34_) {
					gint _tmp35_;
					_tmp35_ = height;
					_tmp32_ = _tmp35_;
				} else {
					gint _tmp36_;
					_tmp36_ = width;
					_tmp32_ = _tmp36_;
				}
				_tmp38_ = region;
				_tmp39_ = _tmp38_->rotate;
				if (_tmp39_) {
					gint _tmp40_;
					_tmp40_ = width;
					_tmp37_ = _tmp40_;
				} else {
					gint _tmp41_;
					_tmp41_ = height;
					_tmp37_ = _tmp41_;
				}
				_tmp42_ = pageToTexture;
				_tmp42__length1 = pageToTexture_length1;
				_tmp43_ = region;
				_tmp44_ = _tmp43_->page;
				_tmp45_ = _tmp44_->id;
				_tmp46_ = _tmp42_[_tmp45_];
				_tmp47_ = region;
				_tmp48_ = _tmp47_->left;
				_tmp49_ = region;
				_tmp50_ = _tmp49_->top;
				_tmp51_ = sdx_graphics_atlas_region_new (_tmp46_, _tmp48_, _tmp50_, _tmp32_, _tmp37_);
				atlasRegion = _tmp51_;
				_tmp52_ = atlasRegion;
				_tmp53_ = region;
				_tmp54_ = _tmp53_->index;
				((SdxGraphicsTextureRegion*) _tmp52_)->index = _tmp54_;
				_tmp55_ = atlasRegion;
				_tmp56_ = region;
				_tmp57_ = _tmp56_->name;
				_tmp58_ = g_strdup (_tmp57_);
				_g_free0 (((SdxGraphicsTextureRegion*) _tmp55_)->name);
				((SdxGraphicsTextureRegion*) _tmp55_)->name = _tmp58_;
				_tmp59_ = atlasRegion;
				_tmp60_ = region;
				_tmp61_ = _tmp60_->offsetX;
				((SdxGraphicsTextureRegion*) _tmp59_)->offsetX = _tmp61_;
				_tmp62_ = atlasRegion;
				_tmp63_ = region;
				_tmp64_ = _tmp63_->offsetY;
				((SdxGraphicsTextureRegion*) _tmp62_)->offsetY = _tmp64_;
				_tmp65_ = atlasRegion;
				_tmp66_ = region;
				_tmp67_ = _tmp66_->originalHeight;
				((SdxGraphicsTextureRegion*) _tmp65_)->originalHeight = _tmp67_;
				_tmp68_ = atlasRegion;
				_tmp69_ = region;
				_tmp70_ = _tmp69_->originalWidth;
				((SdxGraphicsTextureRegion*) _tmp68_)->originalWidth = _tmp70_;
				_tmp71_ = atlasRegion;
				_tmp72_ = region;
				_tmp73_ = _tmp72_->rotate;
				((SdxGraphicsTextureRegion*) _tmp71_)->rotate = _tmp73_;
				_tmp74_ = atlasRegion;
				_tmp75_ = region;
				_tmp76_ = _tmp75_->splits;
				_tmp76__length1 = _tmp75_->splits_length1;
				_tmp77_ = (_tmp76_ != NULL) ? _vala_array_dup4 (_tmp76_, _tmp76__length1) : ((gpointer) _tmp76_);
				_tmp77__length1 = _tmp76__length1;
				((SdxGraphicsTextureRegion*) _tmp74_)->splits = (g_free (((SdxGraphicsTextureRegion*) _tmp74_)->splits), NULL);
				((SdxGraphicsTextureRegion*) _tmp74_)->splits = _tmp77_;
				((SdxGraphicsTextureRegion*) _tmp74_)->splits_length1 = _tmp77__length1;
				_tmp78_ = atlasRegion;
				_tmp79_ = region;
				_tmp80_ = _tmp79_->pads;
				_tmp80__length1 = _tmp79_->pads_length1;
				_tmp81_ = (_tmp80_ != NULL) ? _vala_array_dup5 (_tmp80_, _tmp80__length1) : ((gpointer) _tmp80_);
				_tmp81__length1 = _tmp80__length1;
				((SdxGraphicsTextureRegion*) _tmp78_)->pads = (g_free (((SdxGraphicsTextureRegion*) _tmp78_)->pads), NULL);
				((SdxGraphicsTextureRegion*) _tmp78_)->pads = _tmp81_;
				((SdxGraphicsTextureRegion*) _tmp78_)->pads_length1 = _tmp81__length1;
				_tmp82_ = region;
				_tmp83_ = _tmp82_->flip;
				if (_tmp83_) {
					SdxGraphicsAtlasRegion* _tmp84_;
					_tmp84_ = atlasRegion;
					sdx_graphics_texture_region_Flip ((SdxGraphicsTextureRegion*) _tmp84_, FALSE, TRUE);
				}
				_tmp85_ = atlasRegion;
				_tmp86_ = _sdx_graphics_texture_region_retain0 (_tmp85_);
				self->regions = g_list_append (self->regions, _tmp86_);
				_sdx_graphics_texture_region_release0 (atlasRegion);
				_sdx_graphics_region_release0 (region);
			}
		}
	}
	pageToTexture = (_vala_array_free (pageToTexture, pageToTexture_length1, (GDestroyNotify) sdx_graphics_surface_release), NULL);
	_sdx_graphics_surface_release0 (texture);
}


static void sdx_graphics_texture_atlas_instance_init (SdxGraphicsTextureAtlas * self) {
	self->ref_count = 1;
	self->regions = NULL;
}


void sdx_graphics_texture_atlas_free (SdxGraphicsTextureAtlas * self) {
	__g_list_free__sdx_graphics_texture_region_release0_0 (self->regions);
	g_slice_free (SdxGraphicsTextureAtlas, self);
}


/** 
         * The number at the end of the original image file name, or -1 if none.
         * 
         * When sprites are packed, if the original file name ends with a number, it is stored as the index and is not considered as
         * part of the sprite's name. This is useful for keeping animation frames in order.
         * @see TextureAtlas.FindRegion
         */
SdxGraphicsAtlasRegion* sdx_graphics_atlas_region_new (SdxGraphicsSurfaceTextureSurface* texture, gint x, gint y, gint width, gint height) {
	SdxGraphicsAtlasRegion* self;
	SdxGraphicsSurfaceTextureSurface* _tmp0_;
	gint _tmp1_;
	gint _tmp2_;
	gint _tmp3_;
	gint _tmp4_;
	g_return_val_if_fail (texture != NULL, NULL);
	_tmp0_ = texture;
	_tmp1_ = x;
	_tmp2_ = y;
	_tmp3_ = width;
	_tmp4_ = height;
	self = (SdxGraphicsAtlasRegion*) sdx_graphics_texture_region_from_texture_new (_tmp0_, _tmp1_, _tmp2_, _tmp3_, _tmp4_);
	return self;
}


SdxGraphicsPage* sdx_graphics_page_retain (SdxGraphicsPage* self) {
	SdxGraphicsPage* result = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	g_atomic_int_add ((volatile gint *) (&self->ref_count), 1);
	result = self;
	return result;
}


void sdx_graphics_page_release (SdxGraphicsPage* self) {
	gboolean _tmp0_;
	g_return_if_fail (self != NULL);
	_tmp0_ = g_atomic_int_dec_and_test ((volatile gint *) (&self->ref_count));
	if (_tmp0_) {
		sdx_graphics_page_free (self);
	}
}


SdxGraphicsPage* sdx_graphics_page_new (SdxFilesFileHandle* handle, gint width, gint height, gboolean useMipMaps, SdxGraphicsFormat format, gint minFilter, gint magFilter, gint uWrap, gint vWrap) {
	SdxGraphicsPage* self;
	gint _tmp0_;
	SdxFilesFileHandle* _tmp1_;
	SdxFilesFileHandle* _tmp2_;
	gint _tmp3_;
	gint _tmp4_;
	gboolean _tmp5_;
	SdxGraphicsFormat _tmp6_;
	gint _tmp7_;
	gint _tmp8_;
	gint _tmp9_;
	gint _tmp10_;
	g_return_val_if_fail (handle != NULL, NULL);
	self = g_slice_new0 (SdxGraphicsPage);
	sdx_graphics_page_instance_init (self);
	_tmp0_ = sdx_graphics_page_uniqueId;
	sdx_graphics_page_uniqueId = _tmp0_ + 1;
	self->id = _tmp0_;
	_tmp1_ = handle;
	_tmp2_ = _sdx_files_file_handle_retain0 (_tmp1_);
	_sdx_files_file_handle_release0 (self->textureFile);
	self->textureFile = _tmp2_;
	_tmp3_ = height;
	self->height = _tmp3_;
	_tmp4_ = width;
	self->width = _tmp4_;
	_tmp5_ = useMipMaps;
	self->useMipMaps = _tmp5_;
	_tmp6_ = format;
	self->format = _tmp6_;
	_tmp7_ = minFilter;
	self->minFilter = _tmp7_;
	_tmp8_ = magFilter;
	self->magFilter = _tmp8_;
	_tmp9_ = uWrap;
	self->uWrap = _tmp9_;
	_tmp10_ = vWrap;
	self->vWrap = _tmp10_;
	return self;
}


static void sdx_graphics_page_instance_init (SdxGraphicsPage * self) {
	self->ref_count = 1;
}


void sdx_graphics_page_free (SdxGraphicsPage * self) {
	_sdx_files_file_handle_release0 (self->textureFile);
	_sdx_graphics_surface_release0 (self->texture);
	g_slice_free (SdxGraphicsPage, self);
}


SdxGraphicsRegion* sdx_graphics_region_retain (SdxGraphicsRegion* self) {
	SdxGraphicsRegion* result = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	g_atomic_int_add ((volatile gint *) (&self->ref_count), 1);
	result = self;
	return result;
}


void sdx_graphics_region_release (SdxGraphicsRegion* self) {
	gboolean _tmp0_;
	g_return_if_fail (self != NULL);
	_tmp0_ = g_atomic_int_dec_and_test ((volatile gint *) (&self->ref_count));
	if (_tmp0_) {
		sdx_graphics_region_free (self);
	}
}


SdxGraphicsRegion* sdx_graphics_region_new (SdxGraphicsPage* page, gint left, gint top, gint width, gint height, const gchar* name, gboolean rotatate) {
	SdxGraphicsRegion* self;
	SdxGraphicsPage* _tmp0_;
	SdxGraphicsPage* _tmp1_;
	gint _tmp2_;
	gint _tmp3_;
	gint _tmp4_;
	gint _tmp5_;
	const gchar* _tmp6_;
	gchar* _tmp7_;
	gboolean _tmp8_;
	g_return_val_if_fail (page != NULL, NULL);
	g_return_val_if_fail (name != NULL, NULL);
	self = g_slice_new0 (SdxGraphicsRegion);
	sdx_graphics_region_instance_init (self);
	_tmp0_ = page;
	_tmp1_ = _sdx_graphics_page_retain0 (_tmp0_);
	_sdx_graphics_page_release0 (self->page);
	self->page = _tmp1_;
	_tmp2_ = left;
	self->left = _tmp2_;
	_tmp3_ = top;
	self->top = _tmp3_;
	_tmp4_ = width;
	self->width = _tmp4_;
	_tmp5_ = height;
	self->height = _tmp5_;
	_tmp6_ = name;
	_tmp7_ = g_strdup (_tmp6_);
	_g_free0 (self->name);
	self->name = _tmp7_;
	_tmp8_ = self->rotate;
	self->rotate = _tmp8_;
	self->slice9 = FALSE;
	return self;
}


static void sdx_graphics_region_instance_init (SdxGraphicsRegion * self) {
	self->ref_count = 1;
}


void sdx_graphics_region_free (SdxGraphicsRegion * self) {
	_sdx_graphics_page_release0 (self->page);
	_g_free0 (self->name);
	self->splits = (g_free (self->splits), NULL);
	self->pads = (g_free (self->pads), NULL);
	g_slice_free (SdxGraphicsRegion, self);
}


// symtbl.2 sdx_graphics_page
void sdx_graphics_page_release (SdxGraphicsPage* self);
void sdx_graphics_page_free (SdxGraphicsPage* self);
SdxGraphicsPage* sdx_graphics_page_retain (SdxGraphicsPage* self);
static void _sdx_graphics_page_release0_ (gpointer var) {
	(var == NULL) ? NULL : (var = (sdx_graphics_page_release (var), NULL));
}


static void _g_list_free__sdx_graphics_page_release0_ (GList* self) {
	g_list_foreach (self, (GFunc) _sdx_graphics_page_release0_, NULL);
	g_list_free (self);
}


// symtbl.2 sdx_graphics_region
void sdx_graphics_region_release (SdxGraphicsRegion* self);
void sdx_graphics_region_free (SdxGraphicsRegion* self);
SdxGraphicsRegion* sdx_graphics_region_retain (SdxGraphicsRegion* self);
static void _sdx_graphics_region_release0_ (gpointer var) {
	(var == NULL) ? NULL : (var = (sdx_graphics_region_release (var), NULL));
}


static void _g_list_free__sdx_graphics_region_release0_ (GList* self) {
	g_list_foreach (self, (GFunc) _sdx_graphics_region_release0_, NULL);
	g_list_free (self);
}


SdxGraphicsTextureAtlasData* sdx_graphics_texture_atlas_data_retain (SdxGraphicsTextureAtlasData* self) {
	SdxGraphicsTextureAtlasData* result = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	g_atomic_int_add ((volatile gint *) (&self->ref_count), 1);
	result = self;
	return result;
}


void sdx_graphics_texture_atlas_data_release (SdxGraphicsTextureAtlasData* self) {
	gboolean _tmp0_;
	g_return_if_fail (self != NULL);
	_tmp0_ = g_atomic_int_dec_and_test ((volatile gint *) (&self->ref_count));
	if (_tmp0_) {
		sdx_graphics_texture_atlas_data_free (self);
	}
}


/** 
         * Returns the number of tuple values read (1, 2 or 4). 
         */
gint sdx_graphics_texture_atlas_data_ReadTuple (SdxDataInputStream* reader) {
	gint result = 0;
	gchar* line = NULL;
	SdxDataInputStream* _tmp0_;
	gchar* _tmp1_;
	gchar** ts = NULL;
	const gchar* _tmp2_;
	gchar** _tmp3_;
	gchar** _tmp4_;
	gint ts_length1;
	gint _ts_size_;
	gchar** _tmp5_;
	gint _tmp5__length1;
	gchar** _tmp9_;
	gint _tmp9__length1;
	const gchar* _tmp10_;
	gchar** _tmp11_;
	gchar** _tmp12_;
	gchar** _tmp24_;
	gint _tmp24__length1;
	GError * _inner_error_ = NULL;
	g_return_val_if_fail (reader != NULL, 0);
	_tmp0_ = reader;
	_tmp1_ = sdx_data_input_stream_ReadLine (_tmp0_);
	line = _tmp1_;
	_tmp2_ = line;
	_tmp4_ = _tmp3_ = g_strsplit (_tmp2_, ":", 0);
	ts = _tmp4_;
	ts_length1 = _vala_array_length (_tmp3_);
	_ts_size_ = ts_length1;
	_tmp5_ = ts;
	_tmp5__length1 = ts_length1;
	if (_tmp5__length1 == 0) {
		const gchar* _tmp6_;
		GError* _tmp7_;
		gint _tmp8_ = 0;
		_tmp6_ = line;
		_tmp7_ = g_error_new (SDX_IO_EXCEPTION, SDX_IO_EXCEPTION_InvalidData, "invalid line: %s", _tmp6_);
		_inner_error_ = _tmp7_;
		ts = (_vala_array_free (ts, ts_length1, (GDestroyNotify) g_free), NULL);
		_g_free0 (line);
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
		g_clear_error (&_inner_error_);
		return _tmp8_;
	}
	_tmp9_ = ts;
	_tmp9__length1 = ts_length1;
	_tmp10_ = _tmp9_[1];
	_tmp12_ = _tmp11_ = g_strsplit (_tmp10_, ",", 0);
	sdx_graphics_texture_atlas_data_tuple = (_vala_array_free (sdx_graphics_texture_atlas_data_tuple, sdx_graphics_texture_atlas_data_tuple_length1, (GDestroyNotify) g_free), NULL);
	sdx_graphics_texture_atlas_data_tuple = _tmp12_;
	sdx_graphics_texture_atlas_data_tuple_length1 = _vala_array_length (_tmp11_);
	{
		gint i = 0;
		i = 0;
		{
			gboolean _tmp13_ = FALSE;
			_tmp13_ = TRUE;
			while (TRUE) {
				gint _tmp15_;
				gchar** _tmp16_;
				gint _tmp16__length1;
				gchar** _tmp17_;
				gint _tmp17__length1;
				gint _tmp18_;
				gchar** _tmp19_;
				gint _tmp19__length1;
				gint _tmp20_;
				const gchar* _tmp21_;
				gchar* _tmp22_;
				gchar* _tmp23_;
				if (!_tmp13_) {
					gint _tmp14_;
					_tmp14_ = i;
					i = _tmp14_ + 1;
				}
				_tmp13_ = FALSE;
				_tmp15_ = i;
				_tmp16_ = sdx_graphics_texture_atlas_data_tuple;
				_tmp16__length1 = sdx_graphics_texture_atlas_data_tuple_length1;
				if (!(_tmp15_ < _tmp16__length1)) {
					break;
				}
				_tmp17_ = sdx_graphics_texture_atlas_data_tuple;
				_tmp17__length1 = sdx_graphics_texture_atlas_data_tuple_length1;
				_tmp18_ = i;
				_tmp19_ = sdx_graphics_texture_atlas_data_tuple;
				_tmp19__length1 = sdx_graphics_texture_atlas_data_tuple_length1;
				_tmp20_ = i;
				_tmp21_ = _tmp19_[_tmp20_];
				_tmp22_ = g_strdup (_tmp21_);
				_g_free0 (_tmp17_[_tmp18_]);
				_tmp17_[_tmp18_] = _tmp22_;
				_tmp23_ = _tmp17_[_tmp18_];
			}
		}
	}
	_tmp24_ = sdx_graphics_texture_atlas_data_tuple;
	_tmp24__length1 = sdx_graphics_texture_atlas_data_tuple_length1;
	result = _tmp24__length1;
	ts = (_vala_array_free (ts, ts_length1, (GDestroyNotify) g_free), NULL);
	_g_free0 (line);
	return result;
}


/** 
         * Returns the single value 
         */
gchar* sdx_graphics_texture_atlas_data_ReadValue (SdxDataInputStream* reader) {
	gchar* result = NULL;
	gchar* line = NULL;
	SdxDataInputStream* _tmp0_;
	gchar* _tmp1_;
	gchar** ts = NULL;
	const gchar* _tmp2_;
	gchar** _tmp3_;
	gchar** _tmp4_;
	gint ts_length1;
	gint _ts_size_;
	gchar** _tmp5_;
	gint _tmp5__length1;
	gchar** _tmp8_;
	gint _tmp8__length1;
	const gchar* _tmp9_;
	gchar* _tmp10_;
	GError * _inner_error_ = NULL;
	g_return_val_if_fail (reader != NULL, NULL);
	_tmp0_ = reader;
	_tmp1_ = sdx_data_input_stream_ReadLine (_tmp0_);
	line = _tmp1_;
	_tmp2_ = line;
	_tmp4_ = _tmp3_ = g_strsplit (_tmp2_, ":", 0);
	ts = _tmp4_;
	ts_length1 = _vala_array_length (_tmp3_);
	_ts_size_ = ts_length1;
	_tmp5_ = ts;
	_tmp5__length1 = ts_length1;
	if (_tmp5__length1 == 0) {
		const gchar* _tmp6_;
		GError* _tmp7_;
		_tmp6_ = line;
		_tmp7_ = g_error_new (SDX_IO_EXCEPTION, SDX_IO_EXCEPTION_InvalidData, "invalid line: %s ", _tmp6_);
		_inner_error_ = _tmp7_;
		ts = (_vala_array_free (ts, ts_length1, (GDestroyNotify) g_free), NULL);
		_g_free0 (line);
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
		g_clear_error (&_inner_error_);
		return NULL;
	}
	_tmp8_ = ts;
	_tmp8__length1 = ts_length1;
	_tmp9_ = _tmp8_[1];
	_tmp10_ = g_strdup (_tmp9_);
	result = _tmp10_;
	ts = (_vala_array_free (ts, ts_length1, (GDestroyNotify) g_free), NULL);
	_g_free0 (line);
	return result;
}


/**
         * @param packFile the atlas file
         * @param imagesDir for the bitmap(s)
         * @param flip vert|horz|none
         */
static glong string_strnlen (gchar* str, glong maxlen) {
	glong result = 0L;
	gchar* end = NULL;
	gchar* _tmp0_;
	glong _tmp1_;
	gchar* _tmp2_;
	gchar* _tmp3_;
	_tmp0_ = str;
	_tmp1_ = maxlen;
	_tmp2_ = memchr (_tmp0_, 0, (gsize) _tmp1_);
	end = _tmp2_;
	_tmp3_ = end;
	if (_tmp3_ == NULL) {
		glong _tmp4_;
		_tmp4_ = maxlen;
		result = _tmp4_;
		return result;
	} else {
		gchar* _tmp5_;
		gchar* _tmp6_;
		_tmp5_ = end;
		_tmp6_ = str;
		result = (glong) (_tmp5_ - _tmp6_);
		return result;
	}
}


static gchar* string_SubString (const gchar* self, glong offset, glong len) {
	gchar* result = NULL;
	glong string_length = 0L;
	gboolean _tmp0_ = FALSE;
	glong _tmp1_;
	glong _tmp8_;
	glong _tmp14_;
	glong _tmp17_;
	glong _tmp18_;
	glong _tmp19_;
	glong _tmp20_;
	glong _tmp21_;
	gchar* _tmp22_;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp1_ = offset;
	if (_tmp1_ >= ((glong) 0)) {
		glong _tmp2_;
		_tmp2_ = len;
		_tmp0_ = _tmp2_ >= ((glong) 0);
	} else {
		_tmp0_ = FALSE;
	}
	if (_tmp0_) {
		glong _tmp3_;
		glong _tmp4_;
		glong _tmp5_;
		_tmp3_ = offset;
		_tmp4_ = len;
		_tmp5_ = string_strnlen ((gchar*) self, _tmp3_ + _tmp4_);
		string_length = _tmp5_;
	} else {
		gint _tmp6_;
		gint _tmp7_;
		_tmp6_ = strlen (self);
		_tmp7_ = _tmp6_;
		string_length = (glong) _tmp7_;
	}
	_tmp8_ = offset;
	if (_tmp8_ < ((glong) 0)) {
		glong _tmp9_;
		glong _tmp10_;
		glong _tmp11_;
		_tmp9_ = string_length;
		_tmp10_ = offset;
		offset = _tmp9_ + _tmp10_;
		_tmp11_ = offset;
		g_return_val_if_fail (_tmp11_ >= ((glong) 0), NULL);
	} else {
		glong _tmp12_;
		glong _tmp13_;
		_tmp12_ = offset;
		_tmp13_ = string_length;
		g_return_val_if_fail (_tmp12_ <= _tmp13_, NULL);
	}
	_tmp14_ = len;
	if (_tmp14_ < ((glong) 0)) {
		glong _tmp15_;
		glong _tmp16_;
		_tmp15_ = string_length;
		_tmp16_ = offset;
		len = _tmp15_ - _tmp16_;
	}
	_tmp17_ = offset;
	_tmp18_ = len;
	_tmp19_ = string_length;
	g_return_val_if_fail ((_tmp17_ + _tmp18_) <= _tmp19_, NULL);
	_tmp20_ = offset;
	_tmp21_ = len;
	_tmp22_ = g_strndup (((gchar*) self) + _tmp20_, (gsize) _tmp21_);
	result = _tmp22_;
	return result;
}


static gchar* string_strip (const gchar* self) {
	gchar* result = NULL;
	gchar* _result_ = NULL;
	gchar* _tmp0_;
	const gchar* _tmp1_;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = g_strdup (self);
	_result_ = _tmp0_;
	_tmp1_ = _result_;
	g_strstrip (_tmp1_);
	result = _result_;
	return result;
}


static gboolean bool_Parse (const gchar* str) {
	gboolean result = FALSE;
	const gchar* _tmp0_;
	g_return_val_if_fail (str != NULL, FALSE);
	_tmp0_ = str;
	if (g_strcmp0 (_tmp0_, "true") == 0) {
		result = TRUE;
		return result;
	} else {
		result = FALSE;
		return result;
	}
}


SdxGraphicsTextureAtlasData* sdx_graphics_texture_atlas_data_new (SdxFilesFileHandle* packFile, SdxFilesFileHandle* imagesDir, gboolean flip) {
	SdxGraphicsTextureAtlasData* self;
	SdxDataInputStream* reader = NULL;
	SdxFilesFileHandle* _tmp0_;
	gchar* _tmp1_;
	gchar* _tmp2_;
	SdxDataInputStream* _tmp3_;
	SdxDataInputStream* _tmp4_;
	GError * _inner_error_ = NULL;
	g_return_val_if_fail (packFile != NULL, NULL);
	g_return_val_if_fail (imagesDir != NULL, NULL);
	self = g_slice_new0 (SdxGraphicsTextureAtlasData);
	sdx_graphics_texture_atlas_data_instance_init (self);
	__g_list_free__sdx_graphics_page_release0_0 (self->pages);
	self->pages = NULL;
	__g_list_free__sdx_graphics_region_release0_0 (self->regions);
	self->regions = NULL;
	_tmp0_ = packFile;
	_tmp1_ = sdx_files_file_handle_Read (_tmp0_);
	_tmp2_ = _tmp1_;
	_tmp3_ = sdx_data_input_stream_new (_tmp2_);
	_tmp4_ = _tmp3_;
	_g_free0 (_tmp2_);
	reader = _tmp4_;
	{
		SdxGraphicsPage* pageImage = NULL;
		pageImage = NULL;
		while (TRUE) {
			gchar* line = NULL;
			SdxDataInputStream* _tmp5_;
			gchar* _tmp6_;
			const gchar* _tmp7_;
			const gchar* _tmp8_;
			const gchar* _tmp9_;
			gint _tmp10_;
			gint _tmp11_;
			gchar* _tmp12_;
			gchar* _tmp13_;
			gboolean _tmp14_;
			const gchar* _tmp20_;
			gint _tmp21_;
			gint _tmp22_;
			_tmp5_ = reader;
			_tmp6_ = sdx_data_input_stream_ReadLine (_tmp5_);
			line = _tmp6_;
			_tmp7_ = line;
			if (_tmp7_ == NULL) {
				_g_free0 (line);
				break;
			}
			_tmp8_ = line;
			_tmp9_ = line;
			_tmp10_ = strlen (_tmp9_);
			_tmp11_ = _tmp10_;
			_tmp12_ = string_SubString (_tmp8_, (glong) (_tmp11_ - 1), (glong) -1);
			_tmp13_ = _tmp12_;
			_tmp14_ = g_strcmp0 (_tmp13_, "\r") == 0;
			_g_free0 (_tmp13_);
			if (_tmp14_) {
				const gchar* _tmp15_;
				const gchar* _tmp16_;
				gint _tmp17_;
				gint _tmp18_;
				gchar* _tmp19_;
				_tmp15_ = line;
				_tmp16_ = line;
				_tmp17_ = strlen (_tmp16_);
				_tmp18_ = _tmp17_;
				_tmp19_ = string_SubString (_tmp15_, (glong) 0, (glong) (_tmp18_ - 1));
				_g_free0 (line);
				line = _tmp19_;
			}
			_tmp20_ = line;
			_tmp21_ = strlen (_tmp20_);
			_tmp22_ = _tmp21_;
			if (_tmp22_ == 0) {
				_sdx_graphics_page_release0 (pageImage);
				pageImage = NULL;
			} else {
				SdxGraphicsPage* _tmp23_;
				_tmp23_ = pageImage;
				if (_tmp23_ == NULL) {
					SdxFilesFileHandle* file = NULL;
					SdxFilesFileHandle* _tmp24_;
					const gchar* _tmp25_;
					SdxFilesFileHandle* _tmp26_;
					gint width = 0;
					gint height = 0;
					SdxDataInputStream* _tmp27_;
					gint _tmp28_;
					SdxGraphicsFormat format = 0;
					gchar** _tmp36_;
					gint _tmp36__length1;
					const gchar* _tmp37_;
					gchar* _tmp38_;
					gchar* _tmp39_;
					SdxGraphicsFormat _tmp40_;
					SdxGraphicsFormat _tmp41_;
					SdxDataInputStream* _tmp42_;
					SdxGraphicsTextureFilter min = 0;
					gchar** _tmp43_;
					gint _tmp43__length1;
					const gchar* _tmp44_;
					gchar* _tmp45_;
					gchar* _tmp46_;
					SdxGraphicsTextureFilter _tmp47_;
					SdxGraphicsTextureFilter _tmp48_;
					SdxGraphicsTextureFilter max = 0;
					gchar** _tmp49_;
					gint _tmp49__length1;
					const gchar* _tmp50_;
					gchar* _tmp51_;
					gchar* _tmp52_;
					SdxGraphicsTextureFilter _tmp53_;
					SdxGraphicsTextureFilter _tmp54_;
					gchar* direction = NULL;
					SdxDataInputStream* _tmp55_;
					gchar* _tmp56_;
					SdxGraphicsTextureWrap repeatX = 0;
					SdxGraphicsTextureWrap repeatY = 0;
					const gchar* _tmp57_;
					SdxFilesFileHandle* _tmp60_;
					gint _tmp61_;
					gint _tmp62_;
					SdxGraphicsTextureFilter _tmp63_;
					gboolean _tmp64_;
					SdxGraphicsFormat _tmp65_;
					SdxGraphicsTextureFilter _tmp66_;
					SdxGraphicsTextureFilter _tmp67_;
					SdxGraphicsTextureWrap _tmp68_;
					SdxGraphicsTextureWrap _tmp69_;
					SdxGraphicsPage* _tmp70_;
					SdxGraphicsPage* _tmp71_;
					SdxGraphicsPage* _tmp72_;
					_tmp24_ = imagesDir;
					_tmp25_ = line;
					_tmp26_ = sdx_files_file_handle_Child (_tmp24_, _tmp25_);
					file = _tmp26_;
					width = 0;
					height = 0;
					_tmp27_ = reader;
					_tmp28_ = sdx_graphics_texture_atlas_data_ReadTuple (_tmp27_);
					if (_tmp28_ == 2) {
						gchar** _tmp29_;
						gint _tmp29__length1;
						const gchar* _tmp30_;
						gint _tmp31_;
						gchar** _tmp32_;
						gint _tmp32__length1;
						const gchar* _tmp33_;
						gint _tmp34_;
						SdxDataInputStream* _tmp35_;
						_tmp29_ = sdx_graphics_texture_atlas_data_tuple;
						_tmp29__length1 = sdx_graphics_texture_atlas_data_tuple_length1;
						_tmp30_ = _tmp29_[0];
						_tmp31_ = atoi (_tmp30_);
						width = _tmp31_;
						_tmp32_ = sdx_graphics_texture_atlas_data_tuple;
						_tmp32__length1 = sdx_graphics_texture_atlas_data_tuple_length1;
						_tmp33_ = _tmp32_[1];
						_tmp34_ = atoi (_tmp33_);
						height = _tmp34_;
						_tmp35_ = reader;
						sdx_graphics_texture_atlas_data_ReadTuple (_tmp35_);
					}
					_tmp36_ = sdx_graphics_texture_atlas_data_tuple;
					_tmp36__length1 = sdx_graphics_texture_atlas_data_tuple_length1;
					_tmp37_ = _tmp36_[0];
					_tmp38_ = string_strip (_tmp37_);
					_tmp39_ = _tmp38_;
					_tmp40_ = sdx_graphics_format_from (_tmp39_);
					_tmp41_ = _tmp40_;
					_g_free0 (_tmp39_);
					format = _tmp41_;
					_tmp42_ = reader;
					sdx_graphics_texture_atlas_data_ReadTuple (_tmp42_);
					_tmp43_ = sdx_graphics_texture_atlas_data_tuple;
					_tmp43__length1 = sdx_graphics_texture_atlas_data_tuple_length1;
					_tmp44_ = _tmp43_[0];
					_tmp45_ = string_strip (_tmp44_);
					_tmp46_ = _tmp45_;
					_tmp47_ = sdx_graphics_texture_filter_from (_tmp46_);
					_tmp48_ = _tmp47_;
					_g_free0 (_tmp46_);
					min = _tmp48_;
					_tmp49_ = sdx_graphics_texture_atlas_data_tuple;
					_tmp49__length1 = sdx_graphics_texture_atlas_data_tuple_length1;
					_tmp50_ = _tmp49_[1];
					_tmp51_ = string_strip (_tmp50_);
					_tmp52_ = _tmp51_;
					_tmp53_ = sdx_graphics_texture_filter_from (_tmp52_);
					_tmp54_ = _tmp53_;
					_g_free0 (_tmp52_);
					max = _tmp54_;
					_tmp55_ = reader;
					_tmp56_ = sdx_graphics_texture_atlas_data_ReadValue (_tmp55_);
					direction = _tmp56_;
					repeatX = SDX_GRAPHICS_TEXTURE_WRAP_ClampToEdge;
					repeatY = SDX_GRAPHICS_TEXTURE_WRAP_ClampToEdge;
					_tmp57_ = direction;
					if (g_strcmp0 (_tmp57_, "x") == 0) {
						repeatX = SDX_GRAPHICS_TEXTURE_WRAP_Repeat;
					} else {
						const gchar* _tmp58_;
						_tmp58_ = direction;
						if (g_strcmp0 (_tmp58_, "y") == 0) {
							repeatY = SDX_GRAPHICS_TEXTURE_WRAP_Repeat;
						} else {
							const gchar* _tmp59_;
							_tmp59_ = direction;
							if (g_strcmp0 (_tmp59_, "xy") == 0) {
								repeatX = SDX_GRAPHICS_TEXTURE_WRAP_Repeat;
								repeatY = SDX_GRAPHICS_TEXTURE_WRAP_Repeat;
							}
						}
					}
					_tmp60_ = file;
					_tmp61_ = width;
					_tmp62_ = height;
					_tmp63_ = min;
					_tmp64_ = sdx_graphics_texture_filter_isMipMap (_tmp63_);
					_tmp65_ = format;
					_tmp66_ = min;
					_tmp67_ = max;
					_tmp68_ = repeatX;
					_tmp69_ = repeatY;
					_tmp70_ = sdx_graphics_page_new (_tmp60_, _tmp61_, _tmp62_, _tmp64_, _tmp65_, (gint) _tmp66_, (gint) _tmp67_, (gint) _tmp68_, (gint) _tmp69_);
					_sdx_graphics_page_release0 (pageImage);
					pageImage = _tmp70_;
					_tmp71_ = pageImage;
					_tmp72_ = _sdx_graphics_page_retain0 (_tmp71_);
					self->pages = g_list_append (self->pages, _tmp72_);
					_g_free0 (direction);
					_sdx_files_file_handle_release0 (file);
				} else {
					gboolean rotate = FALSE;
					SdxDataInputStream* _tmp73_;
					gchar* _tmp74_;
					gchar* _tmp75_;
					gboolean _tmp76_;
					gboolean _tmp77_;
					SdxDataInputStream* _tmp78_;
					gint left = 0;
					gchar** _tmp79_;
					gint _tmp79__length1;
					const gchar* _tmp80_;
					gint _tmp81_;
					gint top = 0;
					gchar** _tmp82_;
					gint _tmp82__length1;
					const gchar* _tmp83_;
					gint _tmp84_;
					SdxDataInputStream* _tmp85_;
					gint width = 0;
					gchar** _tmp86_;
					gint _tmp86__length1;
					const gchar* _tmp87_;
					gint _tmp88_;
					gint height = 0;
					gchar** _tmp89_;
					gint _tmp89__length1;
					const gchar* _tmp90_;
					gint _tmp91_;
					SdxGraphicsRegion* region = NULL;
					SdxGraphicsPage* _tmp92_;
					gint _tmp93_;
					gint _tmp94_;
					gint _tmp95_;
					gint _tmp96_;
					const gchar* _tmp97_;
					gboolean _tmp98_;
					SdxGraphicsRegion* _tmp99_;
					SdxDataInputStream* _tmp100_;
					gint _tmp101_;
					SdxGraphicsRegion* _tmp134_;
					gchar** _tmp135_;
					gint _tmp135__length1;
					const gchar* _tmp136_;
					gint _tmp137_;
					SdxGraphicsRegion* _tmp138_;
					gchar** _tmp139_;
					gint _tmp139__length1;
					const gchar* _tmp140_;
					gint _tmp141_;
					SdxDataInputStream* _tmp142_;
					SdxGraphicsRegion* _tmp143_;
					gchar** _tmp144_;
					gint _tmp144__length1;
					const gchar* _tmp145_;
					gint _tmp146_;
					SdxGraphicsRegion* _tmp147_;
					gchar** _tmp148_;
					gint _tmp148__length1;
					const gchar* _tmp149_;
					gint _tmp150_;
					SdxGraphicsRegion* _tmp151_;
					SdxDataInputStream* _tmp152_;
					gchar* _tmp153_;
					gchar* _tmp154_;
					gint _tmp155_;
					gboolean _tmp156_;
					SdxGraphicsRegion* _tmp158_;
					SdxGraphicsRegion* _tmp159_;
					_tmp73_ = reader;
					_tmp74_ = sdx_graphics_texture_atlas_data_ReadValue (_tmp73_);
					_tmp75_ = _tmp74_;
					_tmp76_ = bool_Parse (_tmp75_);
					_tmp77_ = _tmp76_;
					_g_free0 (_tmp75_);
					rotate = _tmp77_;
					_tmp78_ = reader;
					sdx_graphics_texture_atlas_data_ReadTuple (_tmp78_);
					_tmp79_ = sdx_graphics_texture_atlas_data_tuple;
					_tmp79__length1 = sdx_graphics_texture_atlas_data_tuple_length1;
					_tmp80_ = _tmp79_[0];
					_tmp81_ = atoi (_tmp80_);
					left = _tmp81_;
					_tmp82_ = sdx_graphics_texture_atlas_data_tuple;
					_tmp82__length1 = sdx_graphics_texture_atlas_data_tuple_length1;
					_tmp83_ = _tmp82_[1];
					_tmp84_ = atoi (_tmp83_);
					top = _tmp84_;
					_tmp85_ = reader;
					sdx_graphics_texture_atlas_data_ReadTuple (_tmp85_);
					_tmp86_ = sdx_graphics_texture_atlas_data_tuple;
					_tmp86__length1 = sdx_graphics_texture_atlas_data_tuple_length1;
					_tmp87_ = _tmp86_[0];
					_tmp88_ = atoi (_tmp87_);
					width = _tmp88_;
					_tmp89_ = sdx_graphics_texture_atlas_data_tuple;
					_tmp89__length1 = sdx_graphics_texture_atlas_data_tuple_length1;
					_tmp90_ = _tmp89_[1];
					_tmp91_ = atoi (_tmp90_);
					height = _tmp91_;
					_tmp92_ = pageImage;
					_tmp93_ = left;
					_tmp94_ = top;
					_tmp95_ = width;
					_tmp96_ = height;
					_tmp97_ = line;
					_tmp98_ = rotate;
					_tmp99_ = sdx_graphics_region_new (_tmp92_, _tmp93_, _tmp94_, _tmp95_, _tmp96_, _tmp97_, _tmp98_);
					region = _tmp99_;
					_tmp100_ = reader;
					_tmp101_ = sdx_graphics_texture_atlas_data_ReadTuple (_tmp100_);
					if (_tmp101_ == 4) {
						SdxGraphicsRegion* _tmp102_;
						SdxGraphicsRegion* _tmp103_;
						gchar** _tmp104_;
						gint _tmp104__length1;
						const gchar* _tmp105_;
						gint _tmp106_;
						gchar** _tmp107_;
						gint _tmp107__length1;
						const gchar* _tmp108_;
						gint _tmp109_;
						gchar** _tmp110_;
						gint _tmp110__length1;
						const gchar* _tmp111_;
						gint _tmp112_;
						gchar** _tmp113_;
						gint _tmp113__length1;
						const gchar* _tmp114_;
						gint _tmp115_;
						gint* _tmp116_;
						SdxDataInputStream* _tmp117_;
						gint _tmp118_;
						_tmp102_ = region;
						_tmp102_->slice9 = TRUE;
						_tmp103_ = region;
						_tmp104_ = sdx_graphics_texture_atlas_data_tuple;
						_tmp104__length1 = sdx_graphics_texture_atlas_data_tuple_length1;
						_tmp105_ = _tmp104_[0];
						_tmp106_ = atoi (_tmp105_);
						_tmp107_ = sdx_graphics_texture_atlas_data_tuple;
						_tmp107__length1 = sdx_graphics_texture_atlas_data_tuple_length1;
						_tmp108_ = _tmp107_[1];
						_tmp109_ = atoi (_tmp108_);
						_tmp110_ = sdx_graphics_texture_atlas_data_tuple;
						_tmp110__length1 = sdx_graphics_texture_atlas_data_tuple_length1;
						_tmp111_ = _tmp110_[2];
						_tmp112_ = atoi (_tmp111_);
						_tmp113_ = sdx_graphics_texture_atlas_data_tuple;
						_tmp113__length1 = sdx_graphics_texture_atlas_data_tuple_length1;
						_tmp114_ = _tmp113_[3];
						_tmp115_ = atoi (_tmp114_);
						_tmp116_ = g_new0 (gint, 4);
						_tmp116_[0] = _tmp106_;
						_tmp116_[1] = _tmp109_;
						_tmp116_[2] = _tmp112_;
						_tmp116_[3] = _tmp115_;
						_tmp103_->splits = (g_free (_tmp103_->splits), NULL);
						_tmp103_->splits = _tmp116_;
						_tmp103_->splits_length1 = 4;
						_tmp117_ = reader;
						_tmp118_ = sdx_graphics_texture_atlas_data_ReadTuple (_tmp117_);
						if (_tmp118_ == 4) {
							SdxGraphicsRegion* _tmp119_;
							gchar** _tmp120_;
							gint _tmp120__length1;
							const gchar* _tmp121_;
							gint _tmp122_;
							gchar** _tmp123_;
							gint _tmp123__length1;
							const gchar* _tmp124_;
							gint _tmp125_;
							gchar** _tmp126_;
							gint _tmp126__length1;
							const gchar* _tmp127_;
							gint _tmp128_;
							gchar** _tmp129_;
							gint _tmp129__length1;
							const gchar* _tmp130_;
							gint _tmp131_;
							gint* _tmp132_;
							SdxDataInputStream* _tmp133_;
							_tmp119_ = region;
							_tmp120_ = sdx_graphics_texture_atlas_data_tuple;
							_tmp120__length1 = sdx_graphics_texture_atlas_data_tuple_length1;
							_tmp121_ = _tmp120_[0];
							_tmp122_ = atoi (_tmp121_);
							_tmp123_ = sdx_graphics_texture_atlas_data_tuple;
							_tmp123__length1 = sdx_graphics_texture_atlas_data_tuple_length1;
							_tmp124_ = _tmp123_[1];
							_tmp125_ = atoi (_tmp124_);
							_tmp126_ = sdx_graphics_texture_atlas_data_tuple;
							_tmp126__length1 = sdx_graphics_texture_atlas_data_tuple_length1;
							_tmp127_ = _tmp126_[2];
							_tmp128_ = atoi (_tmp127_);
							_tmp129_ = sdx_graphics_texture_atlas_data_tuple;
							_tmp129__length1 = sdx_graphics_texture_atlas_data_tuple_length1;
							_tmp130_ = _tmp129_[3];
							_tmp131_ = atoi (_tmp130_);
							_tmp132_ = g_new0 (gint, 4);
							_tmp132_[0] = _tmp122_;
							_tmp132_[1] = _tmp125_;
							_tmp132_[2] = _tmp128_;
							_tmp132_[3] = _tmp131_;
							_tmp119_->pads = (g_free (_tmp119_->pads), NULL);
							_tmp119_->pads = _tmp132_;
							_tmp119_->pads_length1 = 4;
							_tmp133_ = reader;
							sdx_graphics_texture_atlas_data_ReadTuple (_tmp133_);
						}
					}
					_tmp134_ = region;
					_tmp135_ = sdx_graphics_texture_atlas_data_tuple;
					_tmp135__length1 = sdx_graphics_texture_atlas_data_tuple_length1;
					_tmp136_ = _tmp135_[0];
					_tmp137_ = atoi (_tmp136_);
					_tmp134_->originalWidth = _tmp137_;
					_tmp138_ = region;
					_tmp139_ = sdx_graphics_texture_atlas_data_tuple;
					_tmp139__length1 = sdx_graphics_texture_atlas_data_tuple_length1;
					_tmp140_ = _tmp139_[1];
					_tmp141_ = atoi (_tmp140_);
					_tmp138_->originalHeight = _tmp141_;
					_tmp142_ = reader;
					sdx_graphics_texture_atlas_data_ReadTuple (_tmp142_);
					_tmp143_ = region;
					_tmp144_ = sdx_graphics_texture_atlas_data_tuple;
					_tmp144__length1 = sdx_graphics_texture_atlas_data_tuple_length1;
					_tmp145_ = _tmp144_[0];
					_tmp146_ = atoi (_tmp145_);
					_tmp143_->offsetX = _tmp146_;
					_tmp147_ = region;
					_tmp148_ = sdx_graphics_texture_atlas_data_tuple;
					_tmp148__length1 = sdx_graphics_texture_atlas_data_tuple_length1;
					_tmp149_ = _tmp148_[1];
					_tmp150_ = atoi (_tmp149_);
					_tmp147_->offsetY = _tmp150_;
					_tmp151_ = region;
					_tmp152_ = reader;
					_tmp153_ = sdx_graphics_texture_atlas_data_ReadValue (_tmp152_);
					_tmp154_ = _tmp153_;
					_tmp155_ = atoi (_tmp154_);
					_tmp151_->index = _tmp155_;
					_g_free0 (_tmp154_);
					_tmp156_ = flip;
					if (_tmp156_) {
						SdxGraphicsRegion* _tmp157_;
						_tmp157_ = region;
						_tmp157_->flip = TRUE;
					}
					_tmp158_ = region;
					_tmp159_ = _sdx_graphics_region_retain0 (_tmp158_);
					self->regions = g_list_append (self->regions, _tmp159_);
					_sdx_graphics_region_release0 (region);
				}
			}
			_g_free0 (line);
		}
		_sdx_graphics_page_release0 (pageImage);
	}
	goto __finally0;
	__catch0_g_error:
	{
		GError* e = NULL;
		GError* _tmp160_;
		const gchar* _tmp161_;
		e = _inner_error_;
		_inner_error_ = NULL;
		_tmp160_ = e;
		_tmp161_ = _tmp160_->message;
		g_print ("%s", _tmp161_);
		_g_error_free0 (e);
	}
	__finally0:
	if (G_UNLIKELY (_inner_error_ != NULL)) {
		_sdx_data_input_stream_release0 (reader);
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
		g_clear_error (&_inner_error_);
		return NULL;
	}
	_sdx_data_input_stream_release0 (reader);
	return self;
}


static void sdx_graphics_texture_atlas_data_instance_init (SdxGraphicsTextureAtlasData * self) {
	self->ref_count = 1;
}


void sdx_graphics_texture_atlas_data_free (SdxGraphicsTextureAtlasData * self) {
	__g_list_free__sdx_graphics_page_release0_0 (self->pages);
	__g_list_free__sdx_graphics_region_release0_0 (self->regions);
	g_slice_free (SdxGraphicsTextureAtlasData, self);
}


static void _vala_array_destroy (gpointer array, gint array_length, GDestroyNotify destroy_func) {
	if ((array != NULL) && (destroy_func != NULL)) {
		int i;
		for (i = 0; i < array_length; i = i + 1) {
			if (((gpointer*) array)[i] != NULL) {
				destroy_func (((gpointer*) array)[i]);
			}
		}
	}
}


static void _vala_array_free (gpointer array, gint array_length, GDestroyNotify destroy_func) {
	_vala_array_destroy (array, array_length, destroy_func);
	g_free (array);
}


static gint _vala_array_length (gpointer array) {
	int length;
	length = 0;
	if (array) {
		while (((gpointer*) array)[length]) {
			length++;
		}
	}
	return length;
}




